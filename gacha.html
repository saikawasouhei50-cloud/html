<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kside_</title>
    <!-- Tailwind CSSë¥¼ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥´ê³  ë©‹ì§„ ë””ìì¸ì„ ì ìš©í•©ë‹ˆë‹¤ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* ì‚¬ìš©ì ì •ì˜ ì• ë‹ˆë©”ì´ì…˜ ë° ìŠ¤íƒ€ì¼ */
        @import url('https://fonts.googleapis.com/css2?family=Jua&display=swap');
        body {
            font-family: 'Jua', sans-serif;
            background-image: linear-gradient(to top, #30cfd0 0%, #330867 100%);
        }

        /* ì¹´ë“œê°€ ë‚˜íƒ€ë‚  ë•Œì˜ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.8) translateY(20px); }
            to { opacity: 1; transform: scale(1) translateY(0); }
        }
        
        .card-animation { animation: fadeIn 0.5s ease-out forwards; }

        /* ë“±ê¸‰ë³„ ì¹´ë“œ ë°°ê²½ ê·¸ë¼ë°ì´ì…˜ */
        .rarity-N { background-image: linear-gradient(to top, #cfd9df 0%, #e2ebf0 100%); }
        .rarity-R { background-image: linear-gradient(to top, #a1c4fd 0%, #c2ebf0 100%); }
        .rarity-SR { background-image: linear-gradient(to right, #f83292, #7122fa); }
        .rarity-SSR { background-image: linear-gradient(to right, #f78ca0 0%, #f9748f 19%, #fd868c 60%, #fe9a8b 100%); }

        /* ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
        .gacha-button { transition: all 0.3s ease; }
        .gacha-button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2); }
        
        /* íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .tab-button { transition: all 0.2s ease-in-out; }
        .tab-button.active { background-color: #f6e05e; color: #330867; }
        
        /* ì¹´ë“œ ê°œìˆ˜ ë±ƒì§€ ìŠ¤íƒ€ì¼ */
        .count-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background-color: #e53e3e;
            color: white;
            font-size: 14px;
            font-weight: bold;
            width: 28px;
            height: 28px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 2px solid white;
        }
        /* ë± ìŠ¬ë¡¯ ìŠ¤íƒ€ì¼ */
        .deck-slot {
            border: 2px dashed rgba(255, 255, 255, 0.3);
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.5);
        }
        /* í™ˆ í™”ë©´ ìºë¦­í„° ì´ë¯¸ì§€ */
        #home-character-image {
            max-height: 60vh;
            object-fit: contain;
            filter: drop-shadow(0px 5px 15px rgba(0,0,0,0.5));
            transition: transform 0.3s ease-in-out;
        }
        #home-character-image:hover {
            transform: scale(1.03);
        }
        /* ì´ë²¤íŠ¸ ë°°ë„ˆ ì• ë‹ˆë©”ì´ì…˜ */
        @keyframes pulse-glow {
            0%, 100% { box-shadow: 0 0 15px rgba(255, 255, 100, 0.4); }
            50% { box-shadow: 0 0 25px rgba(255, 255, 100, 0.8); }
        }
        #event-banner {
            animation: pulse-glow 2.5s infinite ease-in-out;
        }
        /* ë½‘ê¸° íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
        .sub-tab-button { transition: all 0.2s ease-in-out; }
        .sub-tab-button.active { background-color: rgba(246, 224, 94, 0.8); color: #330867; }
        
        /* ì „íˆ¬ í™”ë©´ ìŠ¤íƒ€ì¼ */
        #combat-log { scroll-behavior: smooth; }
        .hp-bar-background { background-color: #4a5568; }
        .hp-bar-foreground { background-color: #48bb78; transition: width 0.5s ease-in-out; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-5px); } 75% { transform: translateX(5px); } }
        .shake-animation { animation: shake 0.3s 1; }
        .speed-button.active {
            background-color: #4299e1; /* blue-500 */
            box-shadow: 0 0 10px rgba(66, 153, 225, 0.7);
        }
        .story-content {
            white-space: pre-wrap;
            word-break: keep-all;
        }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div class="w-full max-w-5xl bg-white/10 backdrop-blur-md rounded-2xl shadow-xl text-white p-6 md:p-8">
        
        <!-- ì œëª© ë¶€ë¶„ -->
        <header class="text-center mb-4">
            <h1 class="text-4xl md:text-5xl font-bold tracking-wider text-yellow-300" style="text-shadow: 2px 2px 4px rgba(0,0,0,0.5);">Kside_</h1>
        </header>

        <!-- ì¬í™” ë° íƒ­ ë©”ë‰´ ì˜ì—­ -->
        <div class="flex flex-col md:flex-row justify-between items-center mb-4 gap-4">
            <div class="bg-black/20 rounded-full p-1 flex-shrink-0 flex flex-wrap justify-center">
                <button id="tab-home" class="tab-button active font-bold py-2 px-6 rounded-full">í™ˆ</button>
                <button id="tab-event" class="tab-button font-bold py-2 px-6 rounded-full hidden">ì´ë²¤íŠ¸</button>
                <button id="tab-gacha" class="tab-button font-bold py-2 px-6 rounded-full">ëˆ„êµ°ê°€ì˜ ì„œê³ </button>
                <button id="tab-inventory" class="tab-button font-bold py-2 px-6 rounded-full">ë‹¹ì‹ ì˜ ì±…ì¥</button>
                <button id="tab-deck" class="tab-button font-bold py-2 px-6 rounded-full">í¸ì°¬</button>
                <button id="tab-combat" class="tab-button font-bold py-2 px-6 rounded-full">ë…ì„œ</button>
                <button id="tab-story" class="tab-button font-bold py-2 px-6 rounded-full">ìŠ¤í† ë¦¬</button>
                <button id="tab-collection" class="tab-button font-bold py-2 px-6 rounded-full">ë„ê°</button>
            </div>
            <div class="flex items-center gap-4">
                <div id="event-point-display" class="hidden text-xl font-bold text-pink-300 bg-black/20 py-2 px-4 rounded-full">EVENT P: <span id="event-points">0</span></div>
                <div class="text-xl font-bold text-cyan-300 bg-black/20 py-2 px-4 rounded-full inline-block">ğŸ”– <span id="bookmark-display">10</span> / <span id="max-bookmark-display">10</span><span id="bookmark-timer-container" class="text-sm ml-2"></span></div>
                <div class="text-2xl font-bold text-yellow-300 bg-black/20 py-2 px-6 rounded-full inline-block">ğŸ’ <span id="currency-display">100</span></div>
                <button id="reset-game" class="gacha-button bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-4 rounded-full text-sm">ì´ˆê¸°í™”</button>
            </div>
        </div>

        <!-- ë©”ì¸ ì»¨í…ì¸  ì˜ì—­ -->
        <main>
             <!-- ì €ì¥ ë¶ˆê°€ ê²½ê³  ë©”ì‹œì§€ -->
            <div id="storage-warning" class="hidden text-center bg-red-500 p-2 rounded-lg mb-4">
                <strong>ê²½ê³ :</strong> ê²Œì„ ì§„í–‰ ìƒí™©ì„ ì €ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë¸Œë¼ìš°ì €ê°€ ì‹œí¬ë¦¿ ëª¨ë“œì´ê±°ë‚˜ ì €ì¥ ê¸°ëŠ¥ì´ ë¹„í™œì„±í™”ë˜ì—ˆëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”.
            </div>

            <!-- í™ˆ í™”ë©´ -->
            <div id="home-view">
                <div class="relative min-h-[50vh] flex flex-col justify-center items-center text-center p-4">
                    <!-- ì´ë²¤íŠ¸ ë°°ë„ˆ -->
                    <div id="event-banner" class="hidden absolute top-4 right-4 bg-gradient-to-r from-yellow-400 via-red-500 to-pink-500 p-4 rounded-lg shadow-lg cursor-pointer transform hover:scale-105 transition-transform duration-300 z-10">
                        <h3 class="text-white text-lg font-bold drop-shadow-md">ê¸°ê°„ í•œì • ì´ë²¤íŠ¸!</h3>
                        <p id="event-banner-text" class="text-white text-sm drop-shadow-md"></p>
                    </div>

                    <div id="home-character-container" class="flex-grow flex items-center justify-center cursor-pointer">
                        <img id="home-character-image" src="" alt="ëŒ€í‘œ ìºë¦­í„°" class="max-w-full">
                    </div>
                    <div id="home-dialogue-container" class="w-full max-w-2xl bg-black/30 backdrop-blur-sm p-4 rounded-xl mt-4">
                        <p id="home-character-name" class="font-bold text-lg text-yellow-300"></p>
                        <p id="home-character-dialogue" class="text-white"></p>
                    </div>
                     <div id="home-default-message" class="text-2xl text-gray-300">
                        ë³´ê´€í•¨ì—ì„œ ëŒ€í‘œ ë“±ì¥ì¸ë¬¼ì„ ì„¤ì •í•´ì£¼ì„¸ìš”!
                    </div>
                </div>
            </div>
            
            <!-- ì´ë²¤íŠ¸ í™”ë©´ -->
            <div id="event-view" class="hidden">
                 <div class="bg-black/20 rounded-full p-1 flex justify-center items-center mb-4 max-w-md mx-auto">
                    <button id="event-sub-tab-battle" class="sub-tab-button active w-1/3 font-bold py-2 px-4 rounded-full">ì „íˆ¬</button>
                    <button id="event-sub-tab-story" class="sub-tab-button w-1/3 font-bold py-2 px-4 rounded-full">ìŠ¤í† ë¦¬</button>
                    <button id="event-sub-tab-shop" class="sub-tab-button w-1/3 font-bold py-2 px-4 rounded-full">ìƒì </button>
                </div>

                <div id="event-battle-view">
                    <p class="text-center text-gray-200 mb-4">ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€ì— ë„ì „í•˜ì—¬ ì´ë²¤íŠ¸ í¬ì¸íŠ¸ë¥¼ íšë“í•˜ì„¸ìš”!</p>
                    <div id="event-dungeon-list-container" class="grid grid-cols-2 md:grid-cols-5 gap-4"></div>
                </div>
                <div id="event-story-view" class="hidden">
                    <p class="text-center text-gray-200 mb-4">ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€ë¥¼ í´ë¦¬ì–´í•˜ê³  ìŠ¤í† ë¦¬ë¥¼ í•´ê¸ˆí•˜ì„¸ìš”.</p>
                    <div id="event-story-container" class="space-y-3 max-h-[60vh] overflow-y-auto bg-black/20 p-4 rounded-xl"></div>
                </div>
                <div id="event-shop-view" class="hidden">
                    <p class="text-center text-gray-200 mb-4">íšë“í•œ ì´ë²¤íŠ¸ í¬ì¸íŠ¸ë¡œ íŠ¹ë³„í•œ ë³´ìƒì„ êµí™˜í•˜ì„¸ìš”!</p>
                    <div id="event-shop-container" class="grid grid-cols-1 md:grid-cols-2 gap-4"></div>
                </div>
            </div>

            <!-- ë½‘ê¸° í™”ë©´ -->
            <div id="gacha-view" class="hidden">
                <p class="text-center text-gray-200 mt-2 mb-4">ìš´ëª…ì„ ì‹œí—˜í•˜ì—¬ ë‹¹ì‹ ì˜ ë“±ì¥ì¸ë¬¼ì„ ë§Œë‚˜ë³´ì„¸ìš”.</p>
                <div class="bg-black/20 rounded-full p-1 flex justify-center items-center mb-4 max-w-sm mx-auto">
                    <button id="gacha-tab-normal" class="sub-tab-button active w-1/2 font-bold py-2 px-6 rounded-full">ì¼ë°˜ ë½‘ê¸°</button>
                    <button id="gacha-tab-event" class="sub-tab-button w-1/2 font-bold py-2 px-6 rounded-full hidden">ì´ë²¤íŠ¸ ë½‘ê¸°</button>
                </div>
                <div id="normal-gacha-view">
                    <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-4">
                        <button id="pull-one" class="gacha-button w-full sm:w-auto bg-blue-500 hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-3 px-8 rounded-full shadow-lg">ğŸ’ 1íšŒ ë½‘ê¸° (10)</button>
                        <button id="pull-ten" class="gacha-button w-full sm:w-auto bg-purple-600 hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-3 px-8 rounded-full shadow-lg">ğŸ’ğŸ’ 10íšŒ ë½‘ê¸° (100)</button>
                    </div>
                </div>
                <div id="event-gacha-view" class="hidden">
                    <div id="event-gacha-info" class="text-center p-2 mb-2 rounded-lg bg-yellow-500/20">
                        <p class="font-bold text-yellow-300"></p>
                    </div>
                    <div class="flex flex-col sm:flex-row justify-center items-center gap-4 mb-4">
                        <button id="pull-one-event" class="gacha-button w-full sm:w-auto bg-gradient-to-r from-red-500 to-yellow-500 hover:from-red-600 hover:to-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-3 px-8 rounded-full shadow-lg">ğŸ”¥ 1íšŒ ë½‘ê¸° (10)</button>
                        <button id="pull-ten-event" class="gacha-button w-full sm:w-auto bg-gradient-to-r from-pink-500 to-purple-600 hover:from-pink-600 hover:to-purple-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-3 px-8 rounded-full shadow-lg">ğŸ”¥ğŸ”¥ 10íšŒ ë½‘ê¸° (100)</button>
                    </div>
                </div>
                <div id="message-area" class="text-center text-lg h-8 mb-4 transition-opacity duration-300"></div>
                <div id="results-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 min-h-[200px] bg-black/20 p-4 rounded-xl"></div>
            </div>

            <!-- ë³´ê´€í•¨ í™”ë©´ -->
            <div id="inventory-view" class="hidden">
                 <div class="text-center mb-4">
                    <p class="text-gray-200">ì§€ê¸ˆê¹Œì§€ ìˆ˜ì§‘í•œ ë“±ì¥ì¸ë¬¼ì…ë‹ˆë‹¤.</p>
                    <div class="mt-2 flex justify-center items-center gap-4">
                        <p id="inventory-status" class="text-lg font-bold bg-black/20 py-2 px-4 rounded-full"></p>
                        <button id="expand-inventory" class="gacha-button bg-yellow-500 hover:bg-yellow-600 disabled:opacity-50 disabled:cursor-not-allowed text-black font-bold py-2 px-4 rounded-full shadow-lg text-sm">ì¹¸ í™•ì¥ (ğŸ’50)</button>
                    </div>
                </div>
                <div id="inventory-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 min-h-[400px] max-h-[60vh] overflow-y-auto bg-black/20 p-4 rounded-xl"></div>
            </div>

            <!-- ë± ê´€ë¦¬ í™”ë©´ -->
            <div id="deck-view" class="hidden">
                <div class="text-center mb-4">
                    <p class="text-gray-200">ë“±ì¥ì¸ë¬¼ë“¤ê³¼ í•¨ê»˜ ë…ì„œë¥¼ ì¤€ë¹„í•˜ì„¸ìš”. (5ì¥ í•„ìˆ˜)</p>
                    <div class="mt-2 flex justify-center items-center gap-4">
                        <div id="deck-status" class="text-lg font-bold text-yellow-300"></div>
                        <button id="auto-fill-deck" class="gacha-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-4 rounded-full shadow-lg text-sm">ìë™ í¸ì„±</button>
                    </div>
                </div>
                <div id="deck-slots-container" class="grid grid-cols-5 gap-4 mb-6 bg-black/20 p-4 rounded-xl"></div>
                <div id="deck-inventory-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 min-h-[250px] max-h-[40vh] overflow-y-auto bg-black/20 p-4 rounded-xl"></div>
            </div>
            
            <!-- ì „íˆ¬ í™”ë©´ (ë˜ì „ ì„ íƒ) -->
            <div id="combat-view" class="hidden">
                <div class="text-center mb-4">
                    <p class="text-gray-200">í¸ì°¬í•œ ì±…ìœ¼ë¡œ ë…ì„œì— ë„ì „í•˜ì—¬ ë³´ìƒì„ íšë“í•˜ì„¸ìš”!</p>
                    <p class="text-xl font-bold">í˜„ì¬ ì±… ì „íˆ¬ë ¥: <span id="deck-power-display" class="text-yellow-300">0</span></p>
                </div>
                <div id="dungeon-list-container" class="grid grid-cols-1 md:grid-cols-3 gap-4"></div>
            </div>

            <!-- ì „íˆ¬ ì§„í–‰ í™”ë©´ -->
            <div id="combat-in-progress-view" class="hidden">
                <div class="grid grid-cols-3 gap-4 items-center">
                    <!-- Player Deck -->
                    <div id="combat-player-deck" class="col-span-1 space-y-2"></div>
                    <!-- Monster -->
                    <div id="combat-monster-area" class="col-span-2 flex flex-col items-center"></div>
                </div>

                <div class="flex justify-end items-center gap-2 mt-4">
                    <button id="speed-1x" class="speed-button active bg-gray-600 text-white font-bold py-1 px-3 rounded-full text-sm">1x</button>
                    <button id="speed-2x" class="speed-button bg-gray-600 text-white font-bold py-1 px-3 rounded-full text-sm">2x</button>
                    <button id="speed-4x" class="speed-button bg-gray-600 text-white font-bold py-1 px-3 rounded-full text-sm">4x</button>
                </div>
                <div id="combat-log-container" class="mt-2 bg-black/30 p-4 rounded-lg h-40 overflow-y-auto">
                    <div id="combat-log"></div>
                </div>
                 <div id="combat-result-modal" class="hidden absolute inset-0 bg-black/70 flex justify-center items-center z-20">
                    <div class="bg-gray-800 p-8 rounded-lg text-center">
                        <h2 id="combat-result-title" class="text-4xl font-bold mb-4"></h2>
                        <p id="combat-result-message" class="text-lg mb-6"></p>
                        <button id="close-combat-result" class="gacha-button bg-blue-500 hover:bg-blue-600 text-white font-bold py-2 px-6 rounded-full">í™•ì¸</button>
                    </div>
                </div>
            </div>

             <!-- ë„ê° í™”ë©´ -->
            <div id="collection-view" class="hidden">
                <div class="text-center mb-4">
                    <p class="text-gray-200">ìˆ˜ì§‘í•œ ë“±ì¥ì¸ë¬¼ê³¼ ì•„ì§ ë§Œë‚˜ì§€ ëª»í•œ ë“±ì¥ì¸ë¬¼ì„ í™•ì¸í•˜ì„¸ìš”.</p>
                </div>
                <div id="collection-container" class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4 min-h-[400px] max-h-[60vh] overflow-y-auto bg-black/20 p-4 rounded-xl">
                </div>
            </div>
            
            <!-- ìŠ¤í† ë¦¬ í™”ë©´ -->
            <div id="story-view" class="hidden">
                <div class="text-center mb-4">
                    <p class="text-gray-200">ë…ì„œë¥¼ í†µí•´ ë©”ì¸ ìŠ¤í† ë¦¬ë¥¼ í•´ê¸ˆí•˜ì„¸ìš”.</p>
                </div>
                <div id="main-story-container" class="space-y-3 max-h-[60vh] overflow-y-auto bg-black/20 p-4 rounded-xl">
                </div>
            </div>


            <!-- ì¹´ë“œ ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
            <div id="card-detail-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-30">
                <div class="bg-gray-800 p-6 rounded-lg max-w-lg w-full relative mx-4 max-h-[90vh] overflow-y-auto">
                    <button id="close-card-detail" class="absolute top-3 right-4 text-white text-3xl font-bold hover:text-gray-400">&times;</button>
                    <div class="flex flex-col md:flex-row gap-6">
                        <div class="md:w-1/3">
                            <img id="detail-card-image" src="" alt="Card Image" class="w-full rounded-lg shadow-lg">
                        </div>
                        <div class="md:w-2/3">
                            <h2 id="detail-card-name" class="text-3xl font-bold"></h2>
                            <div class="flex items-center gap-4 mb-4">
                                <p id="detail-card-rarity" class="font-bold text-2xl"></p>
                                <p id="detail-card-faction" class="font-bold text-lg px-3 py-1 rounded-full"></p>
                            </div>
                            <div class="bg-black/20 p-3 rounded-lg mb-4">
                                <h3 class="font-bold text-lg mb-2 text-yellow-300">ëŠ¥ë ¥ì¹˜</h3>
                                <div class="grid grid-cols-3 gap-2 text-center">
                                    <div><p class="text-sm text-gray-400">HP</p><p id="detail-stat-hp" class="font-bold text-lg"></p></div>
                                    <div><p class="text-sm text-gray-400">ATK</p><p id="detail-stat-atk" class="font-bold text-lg"></p></div>
                                    <div><p class="text-sm text-gray-400">DEF</p><p id="detail-stat-def" class="font-bold text-lg"></p></div>
                                </div>
                            </div>
                             <div class="bg-black/20 p-3 rounded-lg">
                                <h3 class="font-bold text-lg mb-2 text-yellow-300">ìŠ¤í‚¬</h3>
                                <div id="detail-skills-container" class="space-y-3"></div>
                            </div>
                        </div>
                    </div>
                    <div id="detail-card-story-container" class="mt-4 bg-black/20 p-4 rounded-lg">
                        <h3 class="font-bold text-lg mb-2 text-yellow-300">ë“±ì¥ì¸ë¬¼ ìŠ¤í† ë¦¬</h3>
                        <div id="detail-card-story" class="text-gray-300 text-sm story-content h-24 overflow-y-auto"></div>
                        <div id="detail-story-pagination" class="flex justify-center items-center mt-2">
                            <button id="detail-story-prev" class="gacha-button text-white font-bold py-1 px-4 rounded-full text-sm">&lt; ì´ì „</button>
                            <span id="detail-story-page-indicator" class="mx-4 text-sm"></span>
                            <button id="detail-story-next" class="gacha-button text-white font-bold py-1 px-4 rounded-full text-sm">ë‹¤ìŒ &gt;</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ë©”ì¸ ìŠ¤í† ë¦¬ ëª¨ë‹¬ -->
            <div id="main-story-modal" class="hidden fixed inset-0 bg-black/70 flex items-center justify-center z-30">
                 <div class="bg-gray-800 p-6 rounded-lg max-w-2xl w-full relative mx-4 max-h-[90vh] flex flex-col">
                    <button id="close-main-story" class="absolute top-3 right-4 text-white text-3xl font-bold hover:text-gray-400">&times;</button>
                    <h2 id="main-story-title" class="text-3xl font-bold mb-4 text-yellow-300 flex-shrink-0"></h2>
                    <div class="flex-grow overflow-y-auto">
                        <p id="main-story-content" class="text-gray-200 leading-relaxed story-content"></p>
                    </div>
                    <div id="main-story-pagination" class="flex justify-center items-center mt-4 flex-shrink-0">
                        <button id="main-story-prev" class="gacha-button text-white font-bold py-1 px-4 rounded-full text-sm">&lt; ì´ì „</button>
                        <span id="main-story-page-indicator" class="mx-4 text-sm"></span>
                        <button id="main-story-next" class="gacha-button text-white font-bold py-1 px-4 rounded-full text-sm">ë‹¤ìŒ &gt;</button>
                    </div>
                 </div>
            </div>

        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- ê²Œì„ ì„¤ì • ---
            const characters = [
                // name(ê³ ìœ ), baseName, rarity, faction, stats, imageUrl, cardImageUrl, dialogues, skills, deathDialogue, story
                { name: '[ì†Œì„¤ê°€] ì„œë„ì§„', baseName: 'ì„œë„ì§„', rarity: 'N', faction: 'íƒì •', stats: { hp: 50, atk: 5, def: 5 }, imageUrl: 'https://placehold.co/300x500/a0aec0/ffffff?text=ì„œë„ì§„', cardImageUrl: 'https://placehold.co/150x180/a0aec0/ffffff?text=ì„œë„ì§„', dialogues: ['ì´ì•¼ê¸°ì˜ ì‹œì‘ì€...'], skills: [{ name: 'ê³ ë‡Œ', dialogue: 'ìŒ...', power: 1.2, type: 'damage' }], deathDialogue: 'ë§ˆê°ì´...', story: `ì„œì¬ì— ì•‰ì•„ ì‰í¬ ëƒ„ìƒˆë¥¼ ë§¡ëŠ” ê²ƒì´ ì„¸ìƒì—ì„œ ê°€ì¥ í° í–‰ë³µì´ì—ˆë˜ ë‚¨ì, ì„œë„ì§„. ê·¸ëŠ” ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì‘ê°€ì˜€ì§€ë§Œ, ì„¸ìƒì˜ ëª…ì„±ë³´ë‹¤ëŠ” ìì‹ ë§Œì˜ ì´ì•¼ê¸° ì„¸ê³„ì— ì¹¨ì í•˜ëŠ” ê²ƒì„ ë” ì¦ê²¼ë‹¤. ê·¸ì˜ ì†ëì—ì„œ íƒœì–´ë‚˜ëŠ” ë¬¸ì¥ë“¤ì€ ë•Œë¡œëŠ” ë‚ ì¹´ë¡œìš´ ì¶”ë¦¬ê°€ ë˜ê³ , ë•Œë¡œëŠ” ë¹„ê·¹ì ì¸ ì‚¬ë‘ì´ ë˜ì—ˆë‹¤. ë…ìë“¤ì€ ê·¸ì˜ ì´ì•¼ê¸°ì— ì—´ê´‘í–ˆì§€ë§Œ, ì •ì‘ ê·¸ ìì‹ ì€ ìì‹ ì˜ ì´ì•¼ê¸°ê°€ í˜„ì‹¤ì„ ì¹¨ë²”í•˜ë¦¬ë¼ê³ ëŠ” ìƒìƒì¡°ì°¨ í•˜ì§€ ëª»í–ˆë‹¤.\n\nê·¸ì˜ ì„œì¬ëŠ” ê³ ìš”í–ˆë‹¤. ì°½ë°–ì˜ ë„ì‹œ ì†ŒìŒë§Œì´ í¬ë¯¸í•˜ê²Œ ë“¤ë ¤ì˜¬ ë¿, ê³µê°„ì„ ì±„ìš°ëŠ” ê²ƒì€ ì˜¤ì§ ì˜¤ë˜ëœ ì¢…ì´ ëƒ„ìƒˆì™€ ê·¸ê°€ ë‚´ì‰¬ëŠ” ê¹Šì€ í•œìˆ¨ë¿ì´ì—ˆë‹¤. ë²½ë©´ì„ ê°€ë“ ì±„ìš´ ì±…ë“¤ì€ ê·¸ê°€ ê±¸ì–´ì˜¨ ê¸¸ì´ì, ì•ìœ¼ë¡œ ë‚˜ì•„ê°ˆ ê¸¸ì„ ë¹„ì¶”ëŠ” ë“±ëŒ€ì˜€ë‹¤. í•˜ì§€ë§Œ ì˜¤ëŠ˜ë”°ë¼ ê·¸ ë“±ëŒ€ëŠ” í¬ë¯¸í–ˆë‹¤. ë‹¤ìŒ ì‘í’ˆì˜ ë§ˆê°ì´ ì½”ì•ì´ì—ˆì§€ë§Œ, ì´ì•¼ê¸°ì˜ ë§ˆì§€ë§‰ ì¡°ê°ì´ ë§ì¶°ì§€ì§€ ì•Šì•˜ë‹¤. ë§ˆì¹˜ ì•ˆê°œ ì†ì„ í—¤ë§¤ëŠ” ê¸°ë¶„ì´ì—ˆë‹¤. ê·¸ì˜ ì£¼ì¸ê³µì€ ë²”ì¸ì˜ ê·¸ë¦¼ìë¥¼ ì«“ê³  ìˆì—ˆì§€ë§Œ, ê·¸ ê·¸ë¦¼ìëŠ” ì†ì— ì¡í ë“¯ ì¡íˆì§€ ì•Šê³  êµë¬˜í•˜ê²Œ ë¹ ì ¸ë‚˜ê°”ë‹¤. "ì  ì¥, ì´ëŸ´ ë•Œê°€ ì•„ë‹Œë°..." ê·¸ëŠ” í—í´ì–´ì§„ ë¨¸ë¦¬ë¥¼ ê±°ì¹ ê²Œ ì“¸ì–´ ë„˜ê²¼ë‹¤.[PAGE_BREAK]ê·¸ëŸ¬ë˜ ì–´ëŠ ë‚ , ê·¸ì˜ ì˜¤ëœ ì¹œêµ¬ì´ì ê²½ìŸìì˜€ë˜ ì‘ê°€ê°€ ì‹¸ëŠ˜í•œ ì‹œì‹ ìœ¼ë¡œ ë°œê²¬ë˜ì—ˆë‹¤. í˜„ì¥ì€ ë§ˆì¹˜ ì†Œì„¤ì˜ í•œ ì¥ë©´ì²˜ëŸ¼ ê¸°ë¬˜í•˜ê²Œ ê¾¸ë©°ì ¸ ìˆì—ˆê³ , ê²½ì°°ì€ ë‹¨ìˆœ ì‚¬ê³ ë¡œ ì¢…ê²°í•˜ë ¤ í–ˆë‹¤. í•˜ì§€ë§Œ ì„œë„ì§„ì€ ì§ê°í–ˆë‹¤. ì´ê²ƒì€ ì‚¬ê³ ê°€ ì•„ë‹ˆë‹¤. ëˆ„êµ°ê°€ê°€ ì˜ë„ì ìœ¼ë¡œ ë§Œë“¤ì–´ë‚¸, ì”í˜¹í•œ ì´ì•¼ê¸°ì˜ ì‹œì‘ì´ë¼ëŠ” ê²ƒì„. ê·¸ëŠ” ì¹œêµ¬ì˜ ì–µìš¸í•œ ì£½ìŒì˜ ì§„ì‹¤ì„ ë°íˆê¸° ìœ„í•´, ê·¸ë¦¬ê³  ìì‹ ì˜ ì´ì•¼ê¸°ê°€ ë”ëŠ” ë”ëŸ½í˜€ì§€ëŠ” ê²ƒì„ ë§‰ê¸° ìœ„í•´ ì§ì ‘ ì‚¬ê±´ì— ë›°ì–´ë“¤ê¸°ë¡œ ê²°ì‹¬í•œë‹¤. ê·¸ì˜ ì†ì—ëŠ” ë§Œë…„í•„ ëŒ€ì‹ , ì°¨ê°€ìš´ ë£¨í˜ê°€ ë“¤ë ¤ ìˆì—ˆë‹¤.` },
                { name: '[íƒì •] ì„œë„ì§„', baseName: 'ì„œë„ì§„', rarity: 'R', faction: 'íƒì •', stats: { hp: 100, atk: 15, def: 10 }, imageUrl: 'https://placehold.co/300x500/63b3ed/ffffff?text=ì„œë„ì§„', cardImageUrl: 'https://placehold.co/150x180/63b3ed/ffffff?text=ì„œë„ì§„', dialogues: ['ì‚¬ê±´ í˜„ì¥ì€ ë³´ì¡´í•´ì£¼ì‹œì£ .'], skills: [{ name: 'ì¶”ë¦¬', dialogue: 'ë²”ì¸ì€ ë°”ë¡œ ë‹¹ì‹ !', power: 1.5, type: 'damage' }], deathDialogue: 'ì´ëŸ°... ì‹¤ìˆ˜ë¥¼...', story: 'ì‚¬ê±´ì„ íŒŒí—¤ì¹˜ê¸° ìœ„í•´, ê·¸ëŠ” íœ ëŒ€ì‹  ë‹ë³´ê¸°ë¥¼ ë“¤ì—ˆë‹¤. ê·¸ì˜ ë‚ ì¹´ë¡œìš´ ì‹œì„ ì€ ê±°ì§“ì„ ê¿°ëš«ëŠ”ë‹¤.' },
                { name: '[ì•…ëª½] ì„œë„ì§„', baseName: 'ì„œë„ì§„', rarity: 'SR', faction: 'íƒì •', stats: { hp: 200, atk: 30, def: 15 }, imageUrl: 'https://placehold.co/300x500/718096/ffffff?text=ì„œë„ì§„', cardImageUrl: 'https://placehold.co/150x180/718096/ffffff?text=ì„œë„ì§„', dialogues: ['ì, ë‚´ ì†Œì„¤ì˜ ë‹¤ìŒ í˜ì´ì§€ë¥¼ ë„˜ê²¨ë³¼ê¹Œ?'], skills: [{ name: 'í˜„ì‹¤ ì¹¨ì‹', dialogue: 'ì´ê²Œ ê¿ˆì´ ì•„ë‹ˆë¼ê³  í™•ì‹ í•  ìˆ˜ ìˆë‚˜?', power: 1.8, type: 'damage' }], deathDialogue: 'ì´ ì•…ëª½ì€... ì´ì œ ì‹œì‘ì¼ ë¿ì´ì•¼...', story: 'ê·¸ê°€ ì“´ ì†Œì„¤ì€ ë‹¨ìˆœí•œ ì´ì•¼ê¸°ê°€ ì•„ë‹ˆë‹¤. ë…ìì˜ ë§ˆìŒì† ê°€ì¥ ê¹Šì€ ê³µí¬ë¥¼ íŒŒê³ ë“œëŠ” í˜„ì‹¤ì˜ ì•…ëª½ ê·¸ ìì²´ë‹¤. ê·¸ëŠ” ìì‹ ì˜ íœ ëì—ì„œ ë²Œì–´ì§€ëŠ” ë¹„ê·¹ì„ ì¦ê¸´ë‹¤.' },
                { name: '[ì‘ê°€ì˜ ìš°ìš¸] ì„œë„ì§„', baseName: 'ì„œë„ì§„', rarity: 'SSR', faction: 'íƒì •', stats: { hp: 380, atk: 42, def: 28 }, imageUrl: 'https://placehold.co/300x500/4a5568/ffffff?text=ì„œë„ì§„', cardImageUrl: 'https://placehold.co/150x180/4a5568/ffffff?text=ì„œë„ì§„', dialogues: ['ì´ì•¼ê¸°ì˜ ëì€... ì–¸ì œë‚˜ ë¹„ê·¹ì´ì§€.'], skills: [{ name: 'í–‰ê°„ ì½ê¸°', dialogue: 'ëª¨ë“  ë¹„ê·¹ì—” ì´ìœ ê°€ ìˆëŠ” ë²•.', power: 2.2, type: 'damage' }, { name: 'ì—í•„ë¡œê·¸', dialogue: 'ì´ì œ, ì´ ì´ì•¼ê¸°ì˜ ë§‰ì„ ë‚´ë¦¬ì£ .', power: 1.5, type: 'debuff_def' }], deathDialogue: 'ê²°êµ­... ë‚˜ ë˜í•œ ì´ì•¼ê¸°ì˜ ì¼ë¶€ì˜€ì„ ë¿ì¸ê°€...', story: 'ë²”ì¸ì˜ ë§ˆìŒì„ ë„ˆë¬´ ê¹Šì´ ì´í•´í•´ë²„ë¦° ì²œì¬ ì‘ê°€. ê·¸ëŠ” ì‚¬ê±´ì˜ ì§„ì‹¤ì„ ê¿°ëš«ì–´ ë³¼ìˆ˜ë¡, ì¸ê°„ ë‚´ë©´ì˜ ê¹Šì€ ì–´ë‘ ê³¼ ë§ˆì£¼í•˜ë©° ëì—†ëŠ” ìš°ìš¸ì— ì ê¸´ë‹¤.' },
                { name: '[í¸ì§‘ì] ìœ¤í•„ê·œ', baseName: 'ìœ¤í•„ê·œ', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 60, atk: 8, def: 3 }, imageUrl: 'https://placehold.co/300x500/a0aec0/ffffff?text=ìœ¤í•„ê·œ', cardImageUrl: 'https://placehold.co/150x180/a0aec0/ffffff?text=ìœ¤í•„ê·œ', dialogues: ['ì˜¤íƒ€ì…ë‹ˆë‹¤.'], skills: [{ name: 'êµì •', dialogue: 'ì´ ë¬¸ì¥ì€ í‹€ë ¸ìŠµë‹ˆë‹¤.', power: 1.3, type: 'damage' }], deathDialogue: 'ë§ˆê°ë§Œì€... ì œë°œ...', story: 'ê·¸ì € ì„±ì‹¤í•œ í¸ì§‘ìì¼ ë¿ì´ì—ˆë‹¤. ë‹´ë‹¹ ì‘ê°€ì˜ ì‚¬ê±´ì— íœ˜ë§ë¦¬ê¸° ì „ê¹Œì§„.' },
                { name: '[ì¡°ìˆ˜] ìœ¤í•„ê·œ', baseName: 'ìœ¤í•„ê·œ', rarity: 'R', faction: 'ì¡°ìˆ˜', stats: { hp: 110, atk: 14, def: 11 }, imageUrl: 'https://placehold.co/300x500/63b3ed/ffffff?text=ìœ¤í•„ê·œ', cardImageUrl: 'https://placehold.co/150x180/63b3ed/ffffff?text=ìœ¤í•„ê·œ', dialogues: ['ì œê°€ ë•ê² ìŠµë‹ˆë‹¤.'], skills: [{ name: 'ìë£Œ ì¡°ì‚¬', dialogue: 'ì°¾ì•˜ìŠµë‹ˆë‹¤!', power: 1.4, type: 'damage' }], deathDialogue: 'ì£„ì†¡í•©ë‹ˆë‹¤...', story: 'ì–´ë¦¬ìˆ™í•´ ë³´ì´ì§€ë§Œ, ê·¸ì˜ ê¼¼ê¼¼í•¨ì€ ì‚¬ê±´ í•´ê²°ì˜ ì¤‘ìš”í•œ ì‹¤ë§ˆë¦¬ê°€ ëœë‹¤.' },
                { name: '[ë™ê±°ì¸] ìœ¤í•„ê·œ', baseName: 'ìœ¤í•„ê·œ', rarity: 'SR', faction: 'ì¡°ìˆ˜', stats: { hp: 240, atk: 26, def: 19 }, imageUrl: 'https://placehold.co/300x500/b794f4/ffffff?text=ìœ¤í•„ê·œ', cardImageUrl: 'https://placehold.co/150x180/b794f4/ffffff?text=ìœ¤í•„ê·œ', dialogues: ['ì§‘ì„¸... ìŠì§€ ì•Šìœ¼ì…¨ì£ ?'], skills: [{ name: 'ì”ì†Œë¦¬', dialogue: 'ë°© ì¢€ ì¹˜ìš°ì„¸ìš”!', power: 1.9, type: 'damage' }], deathDialogue: 'ê·¸ë˜ë„... ì¦ê±°ì› ì–´...', story: 'ì‚¬ê±´ì— íœ˜ë§ë¦° ì‘ê°€ì™€ í•¨ê»˜ ì‚´ë©°, ë³¸ì˜ ì•„ë‹ˆê²Œ ì‚¬ê±´ì˜ ì¤‘ì‹¬ì— ì„œê²Œ ëœë‹¤.' },
                { name: '[ì˜¬ê³§ì€ ì •ì˜] ìœ¤í•„ê·œ', baseName: 'ìœ¤í•„ê·œ', rarity: 'SSR', faction: 'ì¡°ìˆ˜', stats: { hp: 370, atk: 43, def: 29 }, imageUrl: 'https://placehold.co/300x500/f6e05e/000000?text=ìœ¤í•„ê·œ', cardImageUrl: 'https://placehold.co/150x180/f6e05e/000000?text=ìœ¤í•„ê·œ', dialogues: ['ì§„ì‹¤ì„ ì™¸ë©´í•  ìˆœ ì—†ìŠµë‹ˆë‹¤.'], skills: [{ name: 'ë‚´ë¶€ê³ ë°œ', dialogue: 'ì œê°€ ëª¨ë“  ê²ƒì„ ë°íˆê² ìŠµë‹ˆë‹¤.', power: 2.4, type: 'damage' }, { name: 'êµ³ì€ ì˜ì§€', dialogue: 'ì €ëŠ” êº¾ì´ì§€ ì•ŠìŠµë‹ˆë‹¤!', power: 1.8, type: 'vampire' }], deathDialogue: 'ì •ì˜ëŠ”... ì‚´ì•„ìˆë‹¤...', story: 'í‰ë²”í–ˆë˜ ê·¸ëŠ”, ìˆ˜ë§ì€ ë¶ˆì˜ë¥¼ ëª©ê²©í•˜ë©° ìŠ¤ìŠ¤ë¡œê°€ ì •ì˜ì˜ ëª©ì†Œë¦¬ê°€ ë˜ê¸°ë¡œ ê²°ì‹¬í–ˆë‹¤.' },
                { name: '[ì—°êµ¬ì] ìœ¤ì„œì²œ', baseName: 'ìœ¤ì„œì²œ', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 45, atk: 9, def: 4 }, imageUrl: 'https://placehold.co/300x500/a0aec0/ffffff?text=ìœ¤ì„œì²œ', cardImageUrl: 'https://placehold.co/150x180/a0aec0/ffffff?text=ìœ¤ì„œì²œ', dialogues: ['í¥ë¯¸ë¡œìš´ ìƒ˜í”Œì´êµ°.'], skills: [{ name: 'ë¶„ì„', dialogue: 'ê²°ê³¼ê°€ ë‚˜ì™”êµ°.', power: 1.3, type: 'damage' }], deathDialogue: 'ë°ì´í„°ê°€... ë¶€ì¡±í•´...', story: 'ê·¸ì˜ ì—°êµ¬ ë…¸íŠ¸ì—ëŠ” ì´í•´í•  ìˆ˜ ì—†ëŠ” í™”í•™ì‹ë“¤ë§Œ ê°€ë“í–ˆë‹¤.' },
                { name: '[ë²”ì¸] ìœ¤ì„œì²œ', baseName: 'ìœ¤ì„œì²œ', rarity: 'R', faction: 'ë²”ì¸', stats: { hp: 100, atk: 17, def: 9 }, imageUrl: 'https://placehold.co/300x500/63b3ed/ffffff?text=ìœ¤ì„œì²œ', cardImageUrl: 'https://placehold.co/150x180/63b3ed/ffffff?text=ìœ¤ì„œì²œ', dialogues: ['ê³„íšé€šã‚Š...'], skills: [{ name: 'ë…ê·¹ë¬¼', dialogue: 'ì¹˜ì‚¬ëŸ‰ì´ì•¼.', power: 1.6, type: 'damage' }], deathDialogue: 'ê³„íšì— ì—†ì—ˆëŠ”ë°...', story: 'ì²œì¬ì ì¸ ë‘ë‡ŒëŠ” ë•Œë¡œëŠ” ìœ„í—˜í•œ ë°©í–¥ìœ¼ë¡œ íë¥´ê¸°ë„ í•œë‹¤.' },
                { name: '[ì‹¤í—˜ì¥] ìœ¤ì„œì²œ', baseName: 'ìœ¤ì„œì²œ', rarity: 'SR', faction: 'ë²”ì¸', stats: { hp: 260, atk: 24, def: 17 }, imageUrl: 'https://placehold.co/300x500/b794f4/ffffff?text=ìœ¤ì„œì²œ', cardImageUrl: 'https://placehold.co/150x180/b794f4/ffffff?text=ìœ¤ì„œì²œ', dialogues: ['ì´ ì£¼ì‚¬... ì •ë§ ê´œì°®ì€ ê±´ê°€?'], skills: [{ name: 'ì´ìƒ ë°˜ì‘', dialogue: 'ëª¸ì´... ëœ¨ê±°ì›Œ...!', power: 2.0, type: 'damage' }], deathDialogue: 'ê²°ê³¼ëŠ”... ì‹¤íŒ¨ì¸ê°€...', story: 'ìŠ¤ìŠ¤ë¡œë¥¼ ì‹¤í—˜ì²´ë¡œ ì‚¼ëŠ” ê²ƒ. ê·¸ê²ƒì€ ê´‘ê¸°ì¸ê°€, ì•„ë‹ˆë©´ ìœ„ëŒ€í•œ í¬ìƒì¸ê°€.' },
                { name: '[in vivo] ìœ¤ì„œì²œ', baseName: 'ìœ¤ì„œì²œ', rarity: 'SSR', faction: 'íƒì •', stats: { hp: 340, atk: 48, def: 24 }, imageUrl: 'https://placehold.co/300x500/f6e05e/000000?text=ìœ¤ì„œì²œ', cardImageUrl: 'https://placehold.co/150x180/f6e05e/000000?text=ìœ¤ì„œì²œ', dialogues: ['ì¸ë¥˜ë¥¼ ìœ„í•œ í¬ìƒì´ë‹¤.'], skills: [{ name: 'ì„ìƒì‹¤í—˜', dialogue: 'ë„Œ í›Œë¥­í•œ ìƒ˜í”Œì´ì•¼.', power: 2.5, type: 'damage' }, { name: 'ë¶€ì‘ìš©', dialogue: 'ì˜ˆìƒ ë°–ì¸ë°!', power: 1.4, type: 'debuff_def' }], deathDialogue: 'ìµœê³ ì˜... ìƒ˜í”Œì´ì—ˆëŠ”ë°...', story: 'ê·¸ëŠ” ìì‹ ì˜ ì—°êµ¬ê°€ ì„¸ìƒì„ êµ¬ì›í•  ê²ƒì´ë¼ êµ³ê²Œ ë¯¿ê³  ìˆë‹¤. ê·¸ ê³¼ì •ì—ì„œ ë°œìƒí•˜ëŠ” ì‚¬ì†Œí•œ í¬ìƒì€ ì–´ì©” ìˆ˜ ì—†ë‹¤ê³  ìƒê°í•œë‹¤.' },
                { name: '[ì„œì  ì£¼ì¸] í•œ í˜„', baseName: 'í•œ í˜„', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 70, atk: 6, def: 6 }, imageUrl: 'https://placehold.co/300x500/a0aec0/ffffff?text=í•œí˜„', cardImageUrl: 'https://placehold.co/150x180/a0aec0/ffffff?text=í•œí˜„', dialogues: ['ì–´ì„œì˜¤ì„¸ìš”.'], skills: [{ name: 'ì±… ì¶”ì²œ', dialogue: 'ì´ê±´ ì–´ë– ì‹ ì§€?', power: 1.1, type: 'damage' }], deathDialogue: 'ê°€ê²ŒëŠ”... ëˆ„ê°€...', story: 'ë™ë„¤ì˜ ì‘ì€ ì„œì ì„ ìš´ì˜í•˜ëŠ” í‰ë²”í•œ ì²­ë…„. ê·¸ê°€ ìˆ¨ê²¨ì§„ ê³¼ê±°ë¥¼ ê°€ì§€ê³  ìˆë‹¤ëŠ” ì‚¬ì‹¤ì„ ì•„ëŠ” ì´ëŠ” ê±°ì˜ ì—†ë‹¤.' },
                { name: '[ì¡°ìˆ˜] í•œ í˜„', baseName: 'í•œ í˜„', rarity: 'R', faction: 'ì¡°ìˆ˜', stats: { hp: 140, atk: 14, def: 13 }, imageUrl: 'https://placehold.co/300x500/63b3ed/ffffff?text=í•œí˜„', cardImageUrl: 'https://placehold.co/150x180/63b3ed/ffffff?text=í•œí˜„', dialogues: ['ì œê°€ ê°€ë³´ê² ìŠµë‹ˆë‹¤.'], skills: [{ name: 'í˜„ì¥ ì¡°ì‚¬', dialogue: 'ë­”ê°€ ìˆêµ°ìš”.', power: 1.4, type: 'damage' }], deathDialogue: 'ì œê°€... ë„ˆë¬´ ë‚˜ì„°ë‚˜ìš”...', story: 'ì‚¬ê±´ì˜ ì§„ìƒì„ íŒŒí—¤ì¹˜ëŠ” íƒì •ì„ ë³´ë©°, ê·¸ëŠ” ìŠê³  ìˆë˜ ê³¼ê±°ì˜ ìì‹ ì„ ë– ì˜¬ë¦°ë‹¤.' },
                { name: '[ë™í–‰ì¸] í•œ í˜„', baseName: 'í•œ í˜„', rarity: 'SR', faction: 'ì¡°ìˆ˜', stats: { hp: 230, atk: 28, def: 20 }, imageUrl: 'https://placehold.co/300x500/b794f4/ffffff?text=í•œí˜„', cardImageUrl: 'https://placehold.co/150x180/b794f4/ffffff?text=í•œí˜„', dialogues: ['í˜¼ì ê°€ê²Œ ë‘˜ ìˆœ ì—†ì£ .'], skills: [{ name: 'ì—„í˜¸', dialogue: 'ë’¤ëŠ” ë§¡ê²¨ì£¼ì„¸ìš”!', power: 1.7, type: 'damage' }], deathDialogue: 'ë¨¼ì €... ê°€ì„¸ìš”...', story: 'ìœ„í—˜í•œ ê¸¸ì´ë¼ëŠ” ê²ƒì„ ì•Œë©´ì„œë„, ê·¸ëŠ” ë™ë£Œë¥¼ ìœ„í•´ ê¸°êº¼ì´ ê·¸ ê¸¸ì— í•¨ê»˜ ì˜¤ë¥¸ë‹¤.' },
                { name: '[í•œë•ŒëŠ”, íƒì •] í•œ í˜„', baseName: 'í•œ í˜„', rarity: 'SSR', faction: 'íƒì •', stats: { hp: 390, atk: 40, def: 30 }, imageUrl: 'https://placehold.co/300x500/f6e05e/000000?text=í•œí˜„', cardImageUrl: 'https://placehold.co/150x180/f6e05e/000000?text=í•œí˜„', dialogues: ['ì˜¤ëœë§Œì´êµ°, ì´ ê°ê°.'], skills: [{ name: 'ì˜¤ë˜ëœ í†µì°°', dialogue: 'ë²”ì¸ì€... ì´ ì•ˆì— ì—†ì–´.', power: 2.2, type: 'damage' }, { name: 'ê°ì‹¸ê¸°', dialogue: 'ë”ëŠ” ë‹¤ì¹˜ê²Œ ë‘˜ ìˆ˜ ì—†ì§€!', power: 1.9, type: 'vampire' }], deathDialogue: 'ê²°êµ­... ì—¬ê¸°ê¹Œì§€ì¸ê°€...', story: 'ê³¼ê±°ì˜ ëª…ì„±ì„ ë’¤ë¡œ í•˜ê³  í‰ë²”í•œ ì‚¶ì„ íƒí–ˆë˜ ê·¸. í•˜ì§€ë§Œ ëˆˆì•ì˜ ì‚¬ê±´ì€ ê·¸ë¥¼ ë‹¤ì‹œ íƒì •ì˜ ê¸¸ë¡œ ì´ëˆë‹¤.' },
                // ==================== ë„ì²œì˜ ====================
                { name: '[ì—°êµ¬ì] ë„ì²œì˜', baseName: 'ë„ì²œì˜', rarity: 'N', faction: 'íƒì •', stats: { hp: 65, atk: 7, def: 5 }, imageUrl: 'https://placehold.co/300x500/4fd1c5/ffffff?text=ë„ì²œì˜', cardImageUrl: 'https://placehold.co/150x180/4fd1c5/ffffff?text=ë„ì²œì˜', dialogues: ['ê°€ì„¤ì„ ì„¸ì›Œë³´ì£ .'], skills: [{ name: 'ë°ì´í„° ë¶„ì„', dialogue: 'ë³€ìˆ˜ë¥¼ í†µì œí•´ì•¼ í•©ë‹ˆë‹¤.', power: 1.1, type: 'damage' }], deathDialogue: 'ë°ì´í„°ê°€... ë¶€ì¡±í–ˆì–´...', story: 'ì„¸ìƒì˜ ëª¨ë“  í˜„ìƒì„ ë°ì´í„°ë¡œ ì´í•´í•˜ë ¤ëŠ” ëƒ‰ì² í•œ ì—°êµ¬ì. ê·¸ì˜ ì—°êµ¬ì‹¤ì€ ì–¸ì œë‚˜ ì„œëŠ˜í•œ ê³µê¸°ê°€ ê°ëˆë‹¤.' },
                { name: '[íƒì •] ë„ì²œì˜', baseName: 'ë„ì²œì˜', rarity: 'R', faction: 'íƒì •', stats: { hp: 130, atk: 15, def: 12 }, imageUrl: 'https://placehold.co/300x500/319795/ffffff?text=ë„ì²œì˜', cardImageUrl: 'https://placehold.co/150x180/319795/ffffff?text=ë„ì²œì˜', dialogues: ['í˜„ì¥ì€ ê±°ì§“ë§ì„ í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.'], skills: [{ name: 'ì¦ê±° ìˆ˜ì§‘', dialogue: 'ì´ê±´... í¥ë¯¸ë¡­êµ°ìš”.', power: 1.4, type: 'damage' }], deathDialogue: 'ì´ëŸ° ë³€ìˆ˜ëŠ”... ê³„ì‚°ì— ì—†ì—ˆëŠ”ë°...', story: 'ì‚¬ê±´ í˜„ì¥ì„ í•˜ë‚˜ì˜ ê±°ëŒ€í•œ ì‹¤í—˜ì‹¤ë¡œ ê°„ì£¼í•œë‹¤. ê·¸ì—ê²Œ ë¯¸ì œ ì‚¬ê±´ì´ë€ ì•„ì§ ì¦ëª…ë˜ì§€ ì•Šì€ ê°€ì„¤ì¼ ë¿ì´ë‹¤.' },
                { name: '[in vitro] ë„ì²œì˜', baseName: 'ë„ì²œì˜', rarity: 'SR', faction: 'íƒì •', stats: { hp: 220, atk: 29, def: 19 }, imageUrl: 'https://placehold.co/300x500/086f83/ffffff?text=ë„ì²œì˜', cardImageUrl: 'https://placehold.co/150x180/086f83/ffffff?text=ë„ì²œì˜', dialogues: ['ì, ì‹¤í—˜ì„ ì‹œì‘í•˜ì£ .'], skills: [{ name: 'ê°€ì„¤ ê²€ì¦', dialogue: 'ê²°ê³¼ëŠ” ëª…í™•í•˜êµ°ìš”.', power: 1.8, type: 'damage' }], deathDialogue: 'ì˜¤ì—¼... ëì–´...', story: 'í†µì œëœ í™˜ê²½, ì™„ë²½í•œ ë³€ìˆ˜ í†µì œ í•˜ì— ì§„ì‹¤ì„ ê·œëª…í•œë‹¤. ê·¸ì˜ ì†ëì—ì„œ ë²Œì–´ì§€ëŠ” ì‘ì€ ì‹¤í—˜ì€ ì‚¬ê±´ ì „ì²´ë¥¼ ë’¤í”ë“ ë‹¤.' },
                // ==================== ë°•ì—°ìš° ====================
                { name: '[ì—°êµ¬ì] ë°•ì—°ìš°', baseName: 'ë°•ì—°ìš°', rarity: 'N', faction: 'íƒì •', stats: { hp: 75, atk: 5, def: 6 }, imageUrl: 'https://placehold.co/300x500/f6ad55/ffffff?text=ë°•ì—°ìš°', cardImageUrl: 'https://placehold.co/150x180/f6ad55/ffffff?text=ë°•ì—°ìš°', dialogues: ['ê¸°ì´ˆë¶€í„° ì°¨ê·¼ì°¨ê·¼.'], skills: [{ name: 'ë¬¸í—Œ ì¡°ì‚¬', dialogue: 'ì„ í–‰ ì—°êµ¬ë¥¼ ì°¸ê³ í•˜ì£ .', power: 1.1, type: 'damage' }], deathDialogue: 'ì•„ì§...ì´ì—ˆëŠ”ë°...', story: 'ì–¸ì œë‚˜ ë¯¸ì†Œë¥¼ ìƒì§€ ì•ŠëŠ” ê¸ì •ì ì¸ ì„±ê²©ì˜ ìœ ê¸°í™”í•™ ì—°êµ¬ì. ë³µì¡í•œ í™”í•™ êµ¬ì¡°ì‹ ì†ì—ì„œ ì•„ë¦„ë‹¤ì›€ì„ ì°¾ëŠ”ë‹¤.' },
                { name: '[íƒì •] ë°•ì—°ìš°', baseName: 'ë°•ì—°ìš°', rarity: 'R', faction: 'íƒì •', stats: { hp: 150, atk: 12, def: 14 }, imageUrl: 'https://placehold.co/300x500/dd6b20/ffffff?text=ë°•ì—°ìš°', cardImageUrl: 'https://placehold.co/150x180/dd6b20/ffffff?text=ë°•ì—°ìš°', dialogues: ['ì¡°ê°ë“¤ì„ ë§ì¶°ë³¼ê¹Œìš”?'], skills: [{ name: 'ì•Œë¦¬ë°”ì´ ë¶„ì„', dialogue: 'ì´ ì‹œê°„ì—”... ì´ê²Œ ë¶ˆê°€ëŠ¥í•´ìš”.', power: 1.4, type: 'damage' }], deathDialogue: 'ë§ˆì§€ë§‰ í¼ì¦ì´...', story: 'í©ì–´ì§„ ë‹¨ì„œë“¤ì„ ëª¨ì•„ í•˜ë‚˜ì˜ ì§„ì‹¤ë¡œ ì™„ì„±ì‹œí‚¤ëŠ” ê³¼ì •ì„ ì¦ê¸´ë‹¤. ê·¸ì—ê²Œ ì‚¬ê±´ í•´ê²°ì€ ê³§ ì™„ë²½í•œ ë¶„ìë¥¼ í•©ì„±í•˜ëŠ” ê²ƒê³¼ ê°™ë‹¤.' },
                { name: '[total synthesis] ë°•ì—°ìš°', baseName: 'ë°•ì—°ìš°', rarity: 'SR', faction: 'íƒì •', stats: { hp: 240, atk: 25, def: 22 }, imageUrl: 'https://placehold.co/300x500/c05621/ffffff?text=ë°•ì—°ìš°', cardImageUrl: 'https://placehold.co/150x180/c05621/ffffff?text=ë°•ì—°ìš°', dialogues: ['ì, ëª¨ë“  ê²ƒì´ ëª¨ì˜€ìŠµë‹ˆë‹¤.'], skills: [{ name: 'ì „í•©ì„±', dialogue: 'ì´ê²ƒì´ ë°”ë¡œ ì§„ì‹¤ì˜ êµ¬ì¡°ì…ë‹ˆë‹¤!', power: 1.8, type: 'damage' }], deathDialogue: 'ë°˜ì‘ì´... ë©ˆì·„ì–´...', story: 'ì•„ë¬´ê²ƒë„ ì—†ëŠ” ê³³ì—ì„œ ì‹œì‘í•˜ì—¬ ë‹¨ í•˜ë‚˜ì˜ ì™„ë²½í•œ ì§„ì‹¤ì„ êµ¬ì¶•í•´ë‚¸ë‹¤. ê·¸ì˜ í†µì°°ë ¥ì€ ì‚¬ê±´ì˜ ì „ëª¨ë¥¼ ê¿°ëš«ëŠ”ë‹¤.' },
                // ==================== ê°•ì€ìœ¨ ====================
                { name: '[ì—°êµ¬ì] ê°•ì€ìœ¨', baseName: 'ê°•ì€ìœ¨', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 60, atk: 8, def: 5 }, imageUrl: 'https://placehold.co/300x500/76e4f7/000000?text=ê°•ì€ìœ¨', cardImageUrl: 'https://placehold.co/150x180/76e4f7/000000?text=ê°•ì€ìœ¨', dialogues: ['ì‹œë®¬ë ˆì´ì…˜ì„ ëŒë ¤ë³´ê² ìŠµë‹ˆë‹¤.'], skills: [{ name: 'ëª¨ë¸ë§', dialogue: 'ì˜ˆìƒ ê²°ê³¼ëŠ” ì´ë ‡ìŠµë‹ˆë‹¤.', power: 1.1, type: 'damage' }], deathDialogue: 'ê³„ì‚° ì˜¤ë¥˜ì¸ê°€...', story: 'ì»´í“¨í„°ì™€ ìˆ«ìë¥¼ ë” ì‹ ë¢°í•˜ëŠ” ê³„ì‚°í™”í•™ ì—°êµ¬ì. ë³µì¡í•œ í˜„ì‹¤ë³´ë‹¤ëŠ” ê¹”ë”í•œ ê°€ìƒ ì„¸ê³„ì—ì„œì˜ ê³„ì‚°ì„ ì„ í˜¸í•œë‹¤.' },
                { name: '[ì¡°ìˆ˜] ê°•ì€ìœ¨', baseName: 'ê°•ì€ìœ¨', rarity: 'R', faction: 'ì¡°ìˆ˜', stats: { hp: 125, atk: 16, def: 11 }, imageUrl: 'https://placehold.co/300x500/0bc5ea/ffffff?text=ê°•ì€ìœ¨', cardImageUrl: 'https://placehold.co/150x180/0bc5ea/ffffff?text=ê°•ì€ìœ¨', dialogues: ['í•„ìš”í•œ ì •ë³´ëŠ” ì „ë¶€ ëª¨ì•˜ìŠµë‹ˆë‹¤.'], skills: [{ name: 'ì •ë³´ ì²˜ë¦¬', dialogue: 'ì—¬ê¸°ì„œ ìœ ì˜ë¯¸í•œ íŒ¨í„´ì´...', power: 1.4, type: 'damage' }], deathDialogue: 'ì œ ì •ë³´ê°€... í‹€ë ¸ì„ ë¦¬ ì—†ëŠ”ë°...', story: 'íƒì •ì˜ ìš”ì²­ì— ë”°ë¼ ë°©ëŒ€í•œ ì–‘ì˜ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³  ë¶„ì„í•˜ë©° ê·¸ì˜ í™œë™ì„ ë•ëŠ”ë‹¤. ì—¬ì „íˆ ì‚¬ëŒë³´ë‹¨ ìˆ«ìë¥¼ ë¯¿ëŠ”ë‹¤.' },
                { name: '[in silico] ê°•ì€ìœ¨', baseName: 'ê°•ì€ìœ¨', rarity: 'SR', faction: 'ì¡°ìˆ˜', stats: { hp: 210, atk: 30, def: 18 }, imageUrl: 'https://placehold.co/300x500/0987a0/ffffff?text=ê°•ì€ìœ¨', cardImageUrl: 'https://placehold.co/150x180/0987a0/ffffff?text=ê°•ì€ìœ¨', dialogues: ['ëª¨ë“  ê²½ìš°ì˜ ìˆ˜ë¥¼ ì˜ˆì¸¡í–ˆìŠµë‹ˆë‹¤.'], skills: [{ name: 'ì˜ˆì¸¡ ë¶„ì„', dialogue: 'ë²”ì¸ì€, ê·¸ë¦¬ë¡œ ê°ˆ ê²ë‹ˆë‹¤.', power: 1.8, type: 'damage' }], deathDialogue: 'ìµœì í•´ê°€... ì•„ë‹ˆì—ˆë‹¨ ë§ì¸ê°€...', story: 'ì‚¬ê±´ì˜ ëª¨ë“  ì •ë³´ë¥¼ ë°ì´í„°ë¡œ ë³€í™˜í•˜ì—¬ ê°€ì¥ ê°€ëŠ¥ì„±ì´ ë†’ì€ ì§„ì‹¤ì„ ë„ì¶œí•´ë‚¸ë‹¤. ê·¸ì˜ ì˜ˆì¸¡ì€ ê±°ì˜ ë¹—ë‚˜ê°€ëŠ” ë²•ì´ ì—†ë‹¤.' },
                // ==================== ë°±ì •ë¬¸ ====================
                { name: '[ì—°êµ¬ì] ë°±ì •ë¬¸', baseName: 'ë°±ì •ë¬¸', rarity: 'N', faction: 'íƒì •', stats: { hp: 70, atk: 6, def: 6 }, imageUrl: 'https://placehold.co/300x500/fbb6ce/000000?text=ë°±ì •ë¬¸', cardImageUrl: 'https://placehold.co/150x180/fbb6ce/000000?text=ë°±ì •ë¬¸', dialogues: ['ì—ë„ˆì§€ë¥¼ ì¸¡ì •í•´ë³´ì£ .'], skills: [{ name: 'ë¶„ê´‘í•™', dialogue: 'ë¹›ì´ ëª¨ë“  ê±¸ ë§í•´ì¤„ ê²ë‹ˆë‹¤.', power: 1.1, type: 'damage' }], deathDialogue: 'ì—ë„ˆì§€ê°€... ë¶€ì¡±í•´...', story: 'ë“¤ëœ¬ ìƒíƒœì˜ ë¶„ìë¥¼ ì—°êµ¬í•˜ëŠ” ë¬¼ë¦¬í™”í•™ì. í‰ì†Œì—” ì°¨ë¶„í•˜ì§€ë§Œ, í¥ë¯¸ë¡œìš´ í˜„ìƒì„ ë°œê²¬í•˜ë©´ ëˆ„êµ¬ë³´ë‹¤ ëœ¨ê±°ì›Œì§„ë‹¤.' },
                { name: '[íƒì •] ë°±ì •ë¬¸', baseName: 'ë°±ì •ë¬¸', rarity: 'R', faction: 'íƒì •', stats: { hp: 140, atk: 14, def: 13 }, imageUrl: 'https://placehold.co/300x500/f687b3/ffffff?text=ë°±ì •ë¬¸', cardImageUrl: 'https://placehold.co/150x180/f687b3/ffffff?text=ë°±ì •ë¬¸', dialogues: ['ë³´ì´ì§€ ì•ŠëŠ” ì—ë„ˆì§€ê°€ ëŠê»´ì§€ëŠ”êµ°ìš”.'], skills: [{ name: 'ì—´ ì¶”ì ', dialogue: 'ì•„ì§... ì˜¨ê¸°ê°€ ë‚¨ì•„ìˆì–´.', power: 1.4, type: 'damage' }], deathDialogue: 'ê²°ì •ì ì¸ ìˆœê°„ì—...', story: 'ì‚¬ê±´ í˜„ì¥ì— ë‚¨ì€ ë¯¸ì„¸í•œ ì—ë„ˆì§€ì˜ í”ì ì„ ì«“ì•„ ì§„ì‹¤ì— ë‹¤ê°€ê°„ë‹¤. ê·¸ì˜ ëˆˆì—ëŠ” ë³´ì´ì§€ ì•ŠëŠ” ê²ƒë“¤ì´ ë³´ì¸ë‹¤.' },
                { name: '[ì‚¼ì¤‘í•­] ë°±ì •ë¬¸', baseName: 'ë°±ì •ë¬¸', rarity: 'SR', faction: 'íƒì •', stats: { hp: 230, atk: 28, def: 20 }, imageUrl: 'https://placehold.co/300x500/d53f8c/ffffff?text=ë°±ì •ë¬¸', cardImageUrl: 'https://placehold.co/150x180/d53f8c/ffffff?text=ë°±ì •ë¬¸', dialogues: ['ì, ë“¤ë– ë³¼ ì‹œê°„ì…ë‹ˆë‹¤!'], skills: [{ name: 'ì¸ê´‘(ç‡å…‰)', dialogue: 'ìˆ¨ì–´ìˆëŠ” ì§„ì‹¤ì„ ë¹„ì¶°ë¼!', power: 1.8, type: 'damage' }], deathDialogue: 'ë‹¤ì‹œ... ë°”ë‹¥ìƒíƒœë¡œ...', story: 'ì‚¬ê±´ì´ êµì°© ìƒíƒœì— ë¹ ì¡Œì„ ë•Œ, ê·¸ëŠ” í‰ë²”í•œ ìƒíƒœì—ì„œëŠ” ë³´ì´ì§€ ì•ŠëŠ” ì§„ì‹¤ì„ ê¿°ëš«ì–´ ë³´ëŠ” í˜ì„ ë°œíœ˜í•œë‹¤.' },
                // ==================== ë…ê³ ìœ ì§„ ====================
                { name: '[ì†Œì„¤ê°€] ë…ê³ ìœ ì§„', baseName: 'ë…ê³ ìœ ì§„', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 80, atk: 6, def: 5 }, imageUrl: 'https://placehold.co/300x500/9f7aea/ffffff?text=ë…ê³ ìœ ì§„', cardImageUrl: 'https://placehold.co/150x180/9f7aea/ffffff?text=ë…ê³ ìœ ì§„', dialogues: ['ì¬ë¯¸ìˆëŠ” ì´ì•¼ê¸°ë„¤ìš”.'], skills: [{ name: 'ì¸ë¬¼ ì„¤ì •', dialogue: 'ê·¸ ì‚¬ëŒì€... ê·¸ëŸ° ë§ì„ í•  ë¦¬ê°€ ì—†ì–´ìš”.', power: 1.1, type: 'damage' }], deathDialogue: 'ê²°ë§ì´... ì´ë˜ì„  ì•ˆë˜ëŠ”ë°...', story: 'ì‚¬ëŒë“¤ì˜ ì´ì•¼ê¸°ë¥¼ ë“£ê³  ì“°ëŠ” ê²ƒì„ ì¢‹ì•„í•˜ëŠ” ë¯¸ìŠ¤í„°ë¦¬ ì†Œì„¤ê°€. ê·¸ì˜ ìƒìƒë ¥ì€ ë•Œë¡œ í˜„ì‹¤ë³´ë‹¤ ë” í˜„ì‹¤ ê°™ë‹¤.' },
                { name: '[ì¡°ìˆ˜] ë…ê³ ìœ ì§„', baseName: 'ë…ê³ ìœ ì§„', rarity: 'R', faction: 'ì¡°ìˆ˜', stats: { hp: 160, atk: 13, def: 13 }, imageUrl: 'https://placehold.co/300x500/805ad5/ffffff?text=ë…ê³ ìœ ì§„', cardImageUrl: 'https://placehold.co/150x180/805ad5/ffffff?text=ë…ê³ ìœ ì§„', dialogues: ['ë‹¤ìŒ ì´ì•¼ê¸°ê°€ ê¶ê¸ˆí•´ì¡Œê±°ë“ ìš”.'], skills: [{ name: 'ë³µì„  íŒŒì•…', dialogue: 'ì´ê±´ ê·¸ë•Œ ê·¸ ì‚¬ê±´ê³¼ ì´ì–´ì ¸ìˆì–´!', power: 1.4, type: 'damage' }], deathDialogue: 'ì œê°€... ë„ˆë¬´ ê¹Šì´ ë“¤ì–´ì™”ë‚˜ìš”...', story: 'ìì‹ ì´ ì“°ë˜ ì†Œì„¤ë³´ë‹¤ ë” ì†Œì„¤ ê°™ì€ í˜„ì‹¤ì˜ ì‚¬ê±´ì— íœ˜ë§ë¦°ë‹¤. ê·¸ëŠ” ì´ì•¼ê¸°ì˜ ëì„ ë³´ê¸° ìœ„í•´ íƒì •ê³¼ ë™í–‰í•˜ê¸°ë¡œ í•œë‹¤.' },
                { name: '[ë¬´ì‚¬] ë…ê³ ìœ ì§„', baseName: 'ë…ê³ ìœ ì§„', rarity: 'SR', faction: 'ì¡°ìˆ˜', stats: { hp: 250, atk: 30, def: 18 }, imageUrl: 'https://placehold.co/300x500/553c9a/ffffff?text=ë…ê³ ìœ ì§„', cardImageUrl: 'https://placehold.co/150x180/553c9a/ffffff?text=ë…ê³ ìœ ì§„', dialogues: ['ì´ì•¼ê¸°ë¥¼ ì§€í‚¤ê¸° ìœ„í•´ì„œë¼ë©´.'], skills: [{ name: 'ì¼í•„íœ˜ì§€(ä¸€ç­†æ®ä¹‹)', dialogue: 'ì´ ê²€ìœ¼ë¡œ, ê²°ë§ì„ ì“°ê² ë‹¤!', power: 1.8, type: 'damage' }], deathDialogue: 'ì—¬ê¸°ê¹Œì§€ê°€... ì œ ì´ì•¼ê¸°ì¸ê°€ ë´…ë‹ˆë‹¤...', story: 'ê·¸ê°€ ì“°ëŠ” ê²ƒì€ ë” ì´ìƒ íœì´ ì•„ë‹ˆë‹¤. ì†Œì¤‘í•œ ì‚¬ëŒë“¤ê³¼ ìì‹ ì´ ë§Œë“  ì´ì•¼ê¸°ë¥¼ ì§€í‚¤ê¸° ìœ„í•´, ê·¸ëŠ” ìŠê³  ìˆë˜ ê²€ì„ ë‹¤ì‹œ ì¡ì•˜ë‹¤.' },
                // ==================== ì–‘ì„ë¯¼ ====================
                { name: '[ì—°êµ¬ì] ì–‘ì„ë¯¼', baseName: 'ì–‘ì„ë¯¼', rarity: 'N', faction: 'íƒì •', stats: { hp: 70, atk: 7, def: 5 }, imageUrl: 'https://placehold.co/300x500/38a169/ffffff?text=ì–‘ì„ë¯¼', cardImageUrl: 'https://placehold.co/150x180/38a169/ffffff?text=ì–‘ì„ë¯¼', dialogues: ['íë¦„ì„ ì½ì–´ì•¼ í•©ë‹ˆë‹¤.'], skills: [{ name: 'ì´‰ë§¤ ì‘ìš©', dialogue: 'ë°˜ì‘ì„ ì´ëŒì–´ë‚´ì£ .', power: 1.1, type: 'damage' }], deathDialogue: 'ê¸¸ì„... ìƒì—ˆêµ°...', story: 'ë°˜ì‘ì˜ ê²½ë¡œë¥¼ ì„¤ê³„í•˜ê³  ì˜ˆì¸¡í•˜ëŠ” ê²ƒì„ ì „ë¬¸ìœ¼ë¡œ í•˜ëŠ” ì—°êµ¬ì›. ì–¸ì œë‚˜ ê°€ì¥ íš¨ìœ¨ì ì¸ ê¸¸ì„ ì°¾ìœ¼ë ¤ ë…¸ë ¥í•œë‹¤.' },
                { name: '[íƒì •] ì–‘ì„ë¯¼', baseName: 'ì–‘ì„ë¯¼', rarity: 'R', faction: 'íƒì •', stats: { hp: 145, atk: 15, def: 11 }, imageUrl: 'https://placehold.co/300x500/2f855a/ffffff?text=ì–‘ì„ë¯¼', cardImageUrl: 'https://placehold.co/150x180/2f855a/ffffff?text=ì–‘ì„ë¯¼', dialogues: ['ì‚¬ê±´ì˜ íë¦„ì´ ë³´ì…ë‹ˆë‹¤.'], skills: [{ name: 'ê²½ë¡œ ì˜ˆì¸¡', dialogue: 'ë²”ì¸ì€ ë¶„ëª… ê·¸ê³³ìœ¼ë¡œ í–¥í–ˆì„ ê²ë‹ˆë‹¤.', power: 1.4, type: 'damage' }], deathDialogue: 'ì˜ˆìƒì¹˜ ëª»í•œ... ê²½ë¡œì˜€ìŠµë‹ˆë‹¤...', story: 'ìš©ì˜ìì˜ í–‰ë™ íŒ¨í„´ê³¼ ì‚¬ê±´ì˜ ì „ê°œ ê³¼ì •ì„ ë¶„ì„í•˜ì—¬ ë‹¤ìŒ ë‹¨ê³„ë¥¼ ì˜ˆì¸¡í•œë‹¤. ê·¸ì˜ ì˜ˆì¸¡ì€ ëŒ€ë¶€ë¶„ í˜„ì‹¤ì´ ëœë‹¤.' },
                { name: '[ì¸ë„ì] ì–‘ì„ë¯¼', baseName: 'ì–‘ì„ë¯¼', rarity: 'SR', faction: 'íƒì •', stats: { hp: 235, atk: 27, def: 21 }, imageUrl: 'https://placehold.co/300x500/22543d/ffffff?text=ì–‘ì„ë¯¼', cardImageUrl: 'https://placehold.co/150x180/22543d/ffffff?text=ì–‘ì„ë¯¼', dialogues: ['ì œê°€, ê¸¸ì„ ë³´ì—¬ë“œë¦¬ì£ .'], skills: [{ name: 'ìµœë‹¨ ê²½ë¡œ', dialogue: 'ì§„ì‹¤ë¡œ ê°€ëŠ” ê°€ì¥ ë¹ ë¥¸ ê¸¸ì…ë‹ˆë‹¤.', power: 1.8, type: 'damage' }], deathDialogue: 'ì—¬ê¸°ê¹Œì§€... ì•ˆë‚´í•˜ëŠ” ê²ƒì´ ì œ ì—­í• ...', story: 'ë³µì¡í•˜ê²Œ ì–½íŒ ì‚¬ê±´ ì†ì—ì„œ í—¤ë§¤ëŠ” ë™ë£Œë“¤ì„ ìœ„í•´ ê°€ì¥ í™•ì‹¤í•˜ê³  ë¹ ë¥¸ ê¸¸ì„ ì œì‹œí•˜ëŠ” ê¸¸ì¡ì´. ê·¸ì™€ í•¨ê»˜ë¼ë©´ ê¸¸ì„ ìƒì§€ ì•ŠëŠ”ë‹¤.' },
                // ==================== ìœ¤ìœ ì¤€ ====================
                { name: '[í•™ìƒ] ìœ¤ìœ ì¤€', baseName: 'ìœ¤ìœ ì¤€', rarity: 'N', faction: 'ì¡°ìˆ˜', stats: { hp: 65, atk: 5, def: 8 }, imageUrl: 'https://placehold.co/300x500/e53e3e/ffffff?text=ìœ¤ìœ ì¤€', cardImageUrl: 'https://placehold.co/150x180/e53e3e/ffffff?text=ìœ¤ìœ ì¤€', dialogues: ['ì–´? ì €ê±´...'], skills: [{ name: 'ëª©ê²©', dialogue: 'ì œê°€ ë³¸ ê²Œ ë§ë‹¤ë©´...', power: 1.1, type: 'damage' }], deathDialogue: 'ëª» ë³¸ ì²™... í–ˆì–´ì•¼ í–ˆëŠ”ë°...', story: 'í˜¸ê¸°ì‹¬ ë§ê³  ê´€ì°°ë ¥ì´ ë›°ì–´ë‚œ í•™ìƒ. ìš°ì—°íˆ ì‚¬ê±´ì˜ ê²°ì •ì ì¸ ìˆœê°„ì„ ëª©ê²©í•˜ê²Œ ëœë‹¤.' },
                { name: '[ì¡°ìˆ˜] ìœ¤ìœ ì¤€', baseName: 'ìœ¤ìœ ì¤€', rarity: 'R', faction: 'ì¡°ìˆ˜', stats: { hp: 135, atk: 12, def: 15 }, imageUrl: 'https://placehold.co/300x500/c53030/ffffff?text=ìœ¤ìœ ì¤€', cardImageUrl: 'https://placehold.co/150x180/c53030/ffffff?text=ìœ¤ìœ ì¤€', dialogues: ['ì œê°€ ë´¤ì–´ìš”. í™•ì‹¤í•´ìš”.'], skills: [{ name: 'ì¦ì–¸', dialogue: 'ê·¸ë‚ , ê·¸ ì‚¬ëŒì€ ê±°ê¸°ì— ìˆì—ˆì–´ìš”.', power: 1.4, type: 'damage' }], deathDialogue: 'ì œê°€... ë„ì›€ì´ ë˜ì—ˆì„ê¹Œìš”?', story: 'ìì‹ ì˜ ëª©ê²©ì´ ì‚¬ê±´ í•´ê²°ì— ì¤‘ìš”í•œ ë‹¨ì„œê°€ ëœë‹¤ëŠ” ê²ƒì„ ì•Œê³ , ìš©ê¸°ë¥¼ ë‚´ì–´ íƒì •ì„ ë•ê¸° ì‹œì‘í•œë‹¤.' },
                { name: '[ë°©ê´€ì] ìœ¤ìœ ì¤€', baseName: 'ìœ¤ìœ ì¤€', rarity: 'SR', faction: 'ì¡°ìˆ˜', stats: { hp: 225, atk: 26, def: 23 }, imageUrl: 'https://placehold.co/300x500/742a2a/ffffff?text=ìœ¤ìœ ì¤€', cardImageUrl: 'https://placehold.co/150x180/742a2a/ffffff?text=ìœ¤ìœ ì¤€', dialogues: ['...ì €ëŠ” ê·¸ì €, ë³´ê³  ìˆì„ ë¿ì…ë‹ˆë‹¤.'], skills: [{ name: 'ê°ê´€ì  ì‹œì„ ', dialogue: 'ê°ì •ì€... ë°°ì œí•˜ëŠ” í¸ì´ ì¢‹ìŠµë‹ˆë‹¤.', power: 1.8, type: 'damage' }], deathDialogue: 'ê²°êµ­... ì•„ë¬´ê²ƒë„ í•˜ì§€ ëª»í–ˆêµ°.', story: 'ì‚¬ê±´ì˜ ì¶”ì•…í•œ ì§„ì‹¤ê³¼ ë§ˆì£¼í•œ í›„, ê·¸ëŠ” í•œ ê±¸ìŒ ë¬¼ëŸ¬ë‚˜ ëª¨ë“  ê²ƒì„ ì§€ì¼œë³´ê¸°ë¡œ ê²°ì‹¬í•œë‹¤. ë” ì´ìƒ ì„£ë¶ˆë¦¬ ê°œì…í•˜ì§€ ì•Šìœ¼ë¦¬ë¼ ë‹¤ì§í•˜ë©´ì„œ.' }
            ];
            
            const monsters = {
                'ìŠ¬ë¼ì„ í‚¹': { name: 'ìŠ¬ë¼ì„ í‚¹', stats: { hp: 300, atk: 15, def: 10 }, imageUrl: 'https://placehold.co/300x300/a0aec0/ffffff?text=Slime+King' },
                'ì˜¤í¬ ëŒ€ì¥': { name: 'ì˜¤í¬ ëŒ€ì¥', stats: { hp: 800, atk: 30, def: 20 }, imageUrl: 'https://placehold.co/300x300/63b3ed/ffffff?text=Orc+Chief' },
                'ë ˆë“œ ë“œë˜ê³¤': { name: 'ë ˆë“œ ë“œë˜ê³¤', stats: { hp: 2000, atk: 50, def: 35 }, imageUrl: 'https://placehold.co/300x300/f56565/000000?text=Red+Dragon' },
                'ê·¸ë¦¼ì ì•”ì‚´ì': { name: 'ê·¸ë¦¼ì ì•”ì‚´ì', stats: { hp: 1200, atk: 40, def: 15 }, imageUrl: 'https://placehold.co/300x300/4a5568/ffffff?text=Shadow' }
            };

            const dungeons = [
                { name: 'ì´ˆë³´ìì˜ ìˆ²', monsterName: 'ìŠ¬ë¼ì„ í‚¹', rewards: { min: 10, max: 20 } },
                { name: 'ì˜¤í¬ ì ë ¹ì§€', monsterName: 'ì˜¤í¬ ëŒ€ì¥', rewards: { min: 25, max: 40 } },
                { name: 'ìš©ì˜ ë‘¥ì§€', monsterName: 'ë ˆë“œ ë“œë˜ê³¤', rewards: { min: 60, max: 100 } }
            ];
            
            const eventDungeons = [
                { name: '1ì¥', monsterName: 'ìŠ¬ë¼ì„ í‚¹', eventPointReward: 100 },
                { name: '2ì¥', monsterName: 'ìŠ¬ë¼ì„ í‚¹', eventPointReward: 120 },
                { name: '3ì¥', monsterName: 'ì˜¤í¬ ëŒ€ì¥', eventPointReward: 150 },
                { name: '4ì¥', monsterName: 'ì˜¤í¬ ëŒ€ì¥', eventPointReward: 180 },
                { name: '5ì¥', monsterName: 'ê·¸ë¦¼ì ì•”ì‚´ì', eventPointReward: 220 },
                { name: '6ì¥', monsterName: 'ê·¸ë¦¼ì ì•”ì‚´ì', eventPointReward: 250 },
                { name: '7ì¥', monsterName: 'ê·¸ë¦¼ì ì•”ì‚´ì', eventPointReward: 300 },
                { name: '8ì¥', monsterName: 'ë ˆë“œ ë“œë˜ê³¤', eventPointReward: 350 },
                { name: '9ì¥', monsterName: 'ë ˆë“œ ë“œë˜ê³¤', eventPointReward: 400 },
                { name: '10ì¥', monsterName: 'ë ˆë“œ ë“œë˜ê³¤', eventPointReward: 500 }
            ];

            const eventStories = [
                { title: 'ì‚¬ê±´ì˜ ë°œë‹¨', content: `ì–´ëŠ ë‚ , íƒì • ì‚¬ë¬´ì†Œì— í•œ í†µì˜ í¸ì§€ê°€ ë„ì°©í•œë‹¤...` },
                { title: 'ì‚¬ë¼ì§„ ê·¸ë¦¼ì', content: `í¸ì§€ì˜ ë°œì‹ ì¸ì„ ì°¾ì•„ê°„ ê³³ì€ í…… ë¹„ì–´ìˆì—ˆë‹¤...` },
                { title: 'ì²« ë²ˆì§¸ ì¦ì¸', content: `ì‚¬ê±´ì˜ ìœ ì¼í•œ ëª©ê²©ìëŠ” ê²ì— ì§ˆë ¤ ìˆì—ˆë‹¤...` },
                { title: 'ê±°ì§“ëœ ì•Œë¦¬ë°”ì´', content: `ìš©ì˜ìì˜ ì•Œë¦¬ë°”ì´ëŠ” ë„ˆë¬´ë‚˜ë„ ì™„ë²½í–ˆë‹¤...` },
                { title: 'ì–´ë‘  ì†ì˜ ê³„ì•½', content: `ì‚¬ê±´ì˜ ë°°í›„ì—ëŠ” ê±°ëŒ€í•œ ì¡°ì§ì´ ìˆì—ˆë‹¤...` },
                { title: 'ë‘ ë²ˆì§¸ í”¼í•´ì', content: `ë²”ì¸ì˜ ê²½ê³ ì—ë„ ìˆ˜ì‚¬ë¥¼ ê³„ì†í•˜ì, ìƒˆë¡œìš´ í¬ìƒìê°€ ë°œìƒí–ˆë‹¤...` },
                { title: 'ìˆ¨ê²¨ì§„ ë‹¨ì„œ', content: `í”¼í•´ìê°€ ë‚¨ê¸´ ë‹¤ì‰ ë©”ì‹œì§€. ê·¸ ì˜ë¯¸ëŠ” ê³¼ì—°...` },
                { title: 'í•¨ì •', content: `ëª¨ë“  ë‹¨ì„œê°€ í•œ ê³³ì„ ê°€ë¦¬í‚¤ê³  ìˆì—ˆë‹¤. í•˜ì§€ë§Œ ê·¸ê²ƒì€ í•¨ì •ì´ì—ˆë‹¤...` },
                { title: 'ë°°ì‹ ìì˜ ì–¼êµ´', content: `ê°€ì¥ ë¯¿ì—ˆë˜ ë™ë£Œê°€ ë²”ì¸ì´ì—ˆë‹¤ë‹ˆ...` },
                { title: 'ì§„ì‹¤ì˜ ì´ë©´', content: `ëª¨ë“  ì‚¬ê±´ì˜ ë°°í›„ì—ëŠ” ì˜ˆìƒì¹˜ ëª»í•œ ì¸ë¬¼ì´ ìˆì—ˆë‹¤...` }
            ];

            const eventShopItems = [
                { id: 'event_ssr_card', name: '[ì´ë²¤íŠ¸] ì–´ë‘ ì˜ ê³„ì•½ì', type: 'card', cost: 10000, limit: 1, itemData: characters.find(c => c.name === '[ì´ë²¤íŠ¸] ì–´ë‘ ì˜ ê³„ì•½ì') },
                { id: 'gems_100', name: 'ë³´ì„ 100ê°œ', type: 'currency', cost: 1000, limit: 5, itemData: 100 },
                { id: 'gems_500', name: 'ë³´ì„ 500ê°œ', type: 'currency', cost: 4500, limit: 2, itemData: 500 }
            ];


            const mainStories = [
                { title: 'í”„ë¡¤ë¡œê·¸: ë¹„ ë‚´ë¦¬ëŠ” ë°¤', dungeonToUnlock: null, content: `ëŠ¦ì€ ë°¤, ì°½ë°–ì€ ì„¸ì°¨ê²Œ ë¹„ë¥¼ ìŸì•„ë‚´ê³  ìˆì—ˆë‹¤. ë² ìŠ¤íŠ¸ì…€ëŸ¬ ì¶”ë¦¬ ì†Œì„¤ê°€, ì„œë„ì§„ì€ ì„œì¬ì˜ ë‚¡ì€ ì±…ìƒì— ì•‰ì•„ ë¨¸ë¦¬ë¥¼ ì¥ì–´ëœ¯ì—ˆë‹¤. ì½”ì•ìœ¼ë¡œ ë‹¤ê°€ì˜¨ ë§ˆê°, í•˜ì§€ë§Œ ë§ˆì§€ë§‰ ì±•í„°ì˜ íŠ¸ë¦­ì´ ì¢€ì²˜ëŸ¼ ë– ì˜¤ë¥´ì§€ ì•Šì•˜ë‹¤. "ì  ì¥, ì´ëŸ´ ë•Œê°€ ì•„ë‹Œë°..." ìŠ¤ìŠ¤ë¡œì—ê²Œ ì§œì¦ì„ ë‚´ë©° íœì„ ê³ ì³ ì¥ëŠ” ìˆœê°„ì´ì—ˆë‹¤. ì¿µ, ì¿µ, ì¿µ. ë‚¡ì€ í˜„ê´€ë¬¸ì´ ë‘”íƒí•˜ê²Œ ìš¸ë ¸ë‹¤. ì´ ì‹œê°„ì— ì°¾ì•„ì˜¬ ì‚¬ëŒì´ ì—†ëŠ”ë°. ê·€ì°®ìŒê³¼ ë¶ˆì•ˆê°ì´ ë™ì‹œì— ë°€ë ¤ì™”ë‹¤. ê·¸ëŠ” ë§ˆì§€ëª»í•´ ìë¦¬ì—ì„œ ì¼ì–´ë‚˜ ë¬¸ìœ¼ë¡œ í–¥í–ˆë‹¤.\n\në¬¸ì„ ì—´ì, ë¹„ì— í ë»‘ ì –ì€ ë‚¨ìê°€ ì„œ ìˆì—ˆë‹¤. ë„ì²œì˜. í•œë•Œ ê²½ì°°ì´ì—ˆìœ¼ë‚˜ ì§€ê¸ˆì€ í¥ì‹ ì†Œë¥¼ ìš´ì˜í•˜ëŠ”, íƒì •ì´ë¼ê³  ë¶ˆë¦¬ëŠ” ì‚¬ë‚´ì˜€ë‹¤. ê·¸ì˜ ì–¼êµ´ì—ëŠ” í‰ì†Œì˜ ëŠ¥ê¸€ë§ìŒ ëŒ€ì‹  êµ³ì€ ê¸´ì¥ê°ì´ ì„œë ¤ ìˆì—ˆë‹¤. "ì„œ ì‘ê°€, ì˜¤ëœë§Œì´êµ°. í˜¹ì‹œ... ë°•ë¯¼ì¤€í•˜ê³  ì—°ë½ ë‹¿ì•˜ë‚˜?" ë°•ë¯¼ì¤€. ì„œë„ì§„ì˜ ì˜¤ëœ ì¹œêµ¬ì´ì, ë¬¸ë‹¨ ìµœê³ ì˜ ë¼ì´ë²Œì´ì—ˆë‹¤. "ì•„ë‹ˆ, ê·¸ ë…€ì„ì€ ë§ˆê° ë•Œë©´ ë™êµ´ë¡œ ë“¤ì–´ê°€ëŠ” ë†ˆì´ì–ì•„. ì™œ?" ë„ì²œì˜ì€ ë¬´ê²ê²Œ ì…ì„ ì—´ì—ˆë‹¤. "ì˜¤ëŠ˜ ë°¤, ë°•ë¯¼ì¤€ì´ ì£½ì—ˆì–´." ì„œë„ì§„ì˜ ë¨¸ë¦¿ì†ì´ í•˜ì–—ê²Œ ë¹„ì—ˆë‹¤. ë¹—ì†Œë¦¬ê°€ ì•„ë“í•˜ê²Œ ë©€ì–´ì¡Œë‹¤.[PAGE_BREAK]ì •ì‹ ì„ ì°¨ë ¸ì„ ë•Œ, ê·¸ëŠ” ì´ë¯¸ ë„ì²œì˜ì˜ ì°¨ì— íƒ€ê³  ìˆì—ˆë‹¤. ì™€ì´í¼ê°€ ë¹—ë¬¼ì„ ë°€ì–´ë‚´ëŠ” ì†Œë¦¬ë§Œì´ ê¸°ê³„ì ìœ¼ë¡œ ë°˜ë³µë˜ì—ˆë‹¤. "ê²½ì°°ì€... ë­ë¼ê³  í•˜ë‚˜?" ì„œë„ì§„ì´ ê²¨ìš° ëª©ì†Œë¦¬ë¥¼ ì¥ì–´ì§°ë‹¤. "ìì‚´. ì‘ì—…ì‹¤ì—ì„œ ìœ ì„œì™€ í•¨ê»˜ ë°œê²¬ëë‹¤ê³  í•˜ë”êµ°." ë„ì²œì˜ì˜ ëª©ì†Œë¦¬ëŠ” ì°¨ë¶„í–ˆì§€ë§Œ, ê·¸ ì•ˆì— ë‹´ê¸´ ë¶ˆì‹ ì„ ì„œë„ì§„ì€ ëŠë‚„ ìˆ˜ ìˆì—ˆë‹¤. ë°•ë¯¼ì¤€ì€ ìì‚´í•  ìœ„ì¸ì´ ì•„ë‹ˆì—ˆë‹¤. ê·¸ëŠ” ëˆ„êµ¬ë³´ë‹¤ ìì‹ ì˜ ê¸€ì— ëŒ€í•œ ìë¶€ì‹¬ì´ ê°•í–ˆê³ , ë‹¤ìŒ ì‘í’ˆì— ëŒ€í•œ ì—´ì •ìœ¼ë¡œ ë¶ˆíƒ€ì˜¤ë¥´ë˜ ì‚¬ëŒì´ì—ˆë‹¤. ê²Œë‹¤ê°€, ë©°ì¹  ì „ í†µí™”ì—ì„œ ê·¸ëŠ” 'ì„¸ìƒì„ ë†€ë¼ê²Œ í•  íŠ¸ë¦­ì„ ì™„ì„±í–ˆë‹¤'ë©° í¥ë¶„ì„ ê°ì¶”ì§€ ëª»í–ˆë‹¤. ê·¸ëŸ° ê·¸ê°€... ìŠ¤ìŠ¤ë¡œ ëª©ìˆ¨ì„ ëŠì—ˆë‹¤ê³ ?[PAGE_BREAK]ì‘ì—…ì‹¤ ì•ì— ë„ì°©í•˜ì, ìµìˆ™í•œ ë…¸ë€ìƒ‰ í´ë¦¬ìŠ¤ ë¼ì¸ì´ ê·¸ë“¤ì„ ë§ì•˜ë‹¤. í˜„ì¥ì„ ì§€í‚¤ë˜ ì Šì€ ê²½ê´€ì´ ë„ì²œì˜ì„ ì•Œì•„ë³´ê³ ëŠ” ê³¤ë€í•œ í‘œì •ì„ ì§€ì—ˆë‹¤. "ë„ ì„ ë°°ë‹˜, ì—¬ê¸´ ì–´ë–»ê²Œ..." "ì ê¹ ë‘˜ëŸ¬ë³´ê¸°ë§Œ í• ê²Œ. 5ë¶„, ì•„ë‹ˆ 3ë¶„ì´ë©´ ë¼." ë„ì²œì˜ì˜ ë¶€íƒì—ë„ ê²½ê´€ì€ ìš”ì§€ë¶€ë™ì´ì—ˆë‹¤. ê·¸ë•Œ, ì„œë„ì§„ì´ ë‚˜ì„°ë‹¤. "ì œê°€ ê³ ì¸ì˜ ì˜¤ëœ ì¹œêµ¬ì´ì, ì´ ê±´ë¬¼ì˜ ê³µë™ ì†Œìœ ì£¼ì…ë‹ˆë‹¤. ìœ í’ˆì„ í™•ì¸í•´ì•¼ í•  ê¶Œë¦¬ê°€ ìˆìŠµë‹ˆë‹¤." ê·¸ì˜ ë‹¨í˜¸í•œ ëª©ì†Œë¦¬ì— ê²½ê´€ì€ ë§ˆì§€ëª»í•´ ê¸¸ì„ í„°ì£¼ì—ˆë‹¤. ì‘ì—…ì‹¤ì— ë“¤ì–´ì„  ìˆœê°„, ì„œë„ì§„ì€ ìˆ¨ì„ ë©ˆì·„ë‹¤. ê·¸ê³³ì€ ë‹¨ìˆœí•œ ì£½ìŒì˜ í˜„ì¥ì´ ì•„ë‹ˆì—ˆë‹¤. ê·¸ê²ƒì€... ë„ˆë¬´ë‚˜ë„ ì •êµí•˜ê²Œ ì§œì¸, í•˜ë‚˜ì˜ ì™„ë²½í•œ ë¬´ëŒ€ì˜€ë‹¤.` },
                { title: '1ì¥: ì²« ë²ˆì§¸ ì‚¬ê±´', dungeonToUnlock: 'ì´ˆë³´ìì˜ ìˆ²', content: `ë°•ë¯¼ì¤€ì˜ ì‘ì—…ì‹¤ì€... ê¸°ë¬˜í–ˆë‹¤. ë§ˆì¹˜ ëˆ„êµ°ê°€ ì—°ì¶œì´ë¼ë„ í•œ ê²ƒì²˜ëŸ¼, ëª¨ë“  ê²ƒì´ ì§€ë‚˜ì¹˜ê²Œ ê¹”ë”í–ˆë‹¤. í©ì–´ì§„ ì›ê³ ë“¤, ì“°ëŸ¬ì§„ ì‰í¬ë³‘, ì‹¬ì§€ì–´ëŠ” ë°”ë‹¥ì— ê·¸ì–´ì§„ í•ìêµ­ê¹Œì§€ë„ ë§ˆì¹˜ ì •êµí•˜ê²Œ ê³„ì‚°ëœ ì†Œí’ˆì²˜ëŸ¼ ë³´ì˜€ë‹¤. "ìì‚´ë¡œ ì¢…ê²°ë  ê²ƒ ê°™êµ°." ë„ì²œì˜ì´ ì”ì“¸í•˜ê²Œ ë§í–ˆë‹¤. "ìœ ì„œë„ ë°œê²¬ëê³ , ì™¸ë¶€ ì¹¨ì…ì˜ í”ì ë„ ì—†ìœ¼ë‹ˆ." í•˜ì§€ë§Œ ì„œë„ì§„ì€ ê³ ê°œë¥¼ ì €ì—ˆë‹¤. "ì•„ë‹ˆ, ì´ê±´ ìì‚´ì´ ì•„ë‹ˆì•¼. ì´ê±´... ë©”ì‹œì§€ì•¼." ê·¸ì˜ ëˆˆì´ ì‘ì—…ì‹¤ í•œêµ¬ì„, ë°•ë¯¼ì¤€ì´ ì•„ë¼ë˜ í•œì •íŒ ë§Œë…„í•„ ì¼€ì´ìŠ¤ì— ë©ˆì·„ë‹¤. ì¼€ì´ìŠ¤ëŠ” ë¹„ì–´ ìˆì—ˆë‹¤. ë°•ë¯¼ì¤€ì€ ì™¼ì†ì¡ì´ì˜€ë‹¤. í•˜ì§€ë§Œ ë°”ë‹¥ì— ë–¨ì–´ì§„ íœì€ ì˜¤ë¥¸ì†ì¡ì´ìš©ì´ì—ˆë‹¤. ê·¸ë¦¬ê³  ê·¸ê°€ ë§ˆì§€ë§‰ìœ¼ë¡œ ì§‘í•„í•˜ë˜ ì›ê³ ì˜ ì œëª©ì€, 'ì™„ë²½í•œ ìì‚´'.[PAGE_BREAK]ì„œë„ì§„ì€ ë„ì²œì˜ì—ê²Œ ìì‹ ì˜ ì¶”ë¦¬ë¥¼ í„¸ì–´ë†“ì•˜ë‹¤. ì´ê²ƒì€ ìì‚´ë¡œ ìœ„ì¥ëœ íƒ€ì‚´ì´ë©°, ë²”ì¸ì€ ë°•ë¯¼ì¤€ì˜ ì†Œì„¤ì„ ëª¨ë°©í•˜ì—¬ í˜„ì¥ì„ ê¾¸ëª„ë‹¤ëŠ” ê²ƒ. ê·¸ë¦¬ê³  ë²”ì¸ì€ ë¶„ëª…, ë°•ë¯¼ì¤€ê³¼ ìì‹ ì„ ëª¨ë‘ ì•„ëŠ” ì¸ë¬¼ì¼ ê²ƒì´ë¼ê³ . ë„ì²œì˜ì€ ì„œë„ì§„ì˜ ë‚ ì¹´ë¡œìš´ ê´€ì°°ë ¥ì— í˜€ë¥¼ ë‚´ë‘˜ë €ë‹¤. ê²½ì°°ì€ ê·¸ì˜ ì£¼ì¥ì„ ë¬µì‚´í–ˆì§€ë§Œ, ë„ì²œì˜ì€ ë‹¬ëë‹¤. "ì¢‹ì•„. ê²½ì°°ì´ ì•ˆ ì›€ì§ì¸ë‹¤ë©´, ìš°ë¦¬ê°€ ì§ì ‘ ì›€ì§ì´ë©´ ë˜ì§€. ì§„ì‹¤ì„ ë°í˜€ë‚´ëŠ” ê²Œ íƒì •ì˜ ì¼ì´ë‹ˆê¹Œ. ì–´ë•Œ, ì„œ ì‘ê°€. ë‚˜ì™€ í•¨ê»˜ ì´ ì†Œì„¤ì˜ ê²°ë§ì„ í™•ì¸í•´ ë³´ê² ë‚˜?" ê·¸ë ‡ê²Œ ì†Œì„¤ê°€ì™€ íƒì •ì˜ ê¸°ë¬˜í•œ ê³µì¡°ê°€ ì‹œì‘ë˜ì—ˆë‹¤.[PAGE_BREAK]ê·¸ë“¤ì€ ê°€ì¥ ë¨¼ì € ë°•ë¯¼ì¤€ì˜ ì£¼ë³€ ì¸ë¬¼ë“¤ì„ íƒë¬¸í•˜ê¸° ì‹œì‘í–ˆë‹¤. ì¶œíŒì‚¬ í¸ì§‘ìì¸ ìœ¤í•„ê·œëŠ” ë°•ë¯¼ì¤€ì´ ìµœê·¼ ê·¹ì‹¬í•œ ìŠ¤íŠ¸ë ˆìŠ¤ì— ì‹œë‹¬ë ¸ë‹¤ê³  ì¦ì–¸í–ˆë‹¤. "ë§ˆê° ì••ë°•ë„ ìˆì—ˆê³ ... ìì‹ ì˜ ê¸€ì´ í•œê³„ì— ë¶€ë”ªí˜”ë‹¤ëŠ” ë§ì„ ìì£¼ í•˜ì…¨ì–´ìš”." ê·¸ì˜ ì•ˆê²½ ë„ˆë¨¸ë¡œ ê±±ì •ìŠ¤ëŸ¬ìš´ ëˆˆë¹›ì´ ë¹„ì³¤ë‹¤. ë°˜ë©´, ì‹ ì§„ ì‘ê°€ì´ì ë°•ë¯¼ì¤€ì˜ í›„ë°°ì˜€ë˜ ìœ¤ì„œì²œì€ ì¡°ê¸ˆ ë‹¤ë¥¸ ì´ì•¼ê¸°ë¥¼ í–ˆë‹¤. "ì„ ë°°ëŠ”... ëˆ„êµ°ê°€ ìì‹ ì„ ìœ„í˜‘í•˜ê³  ìˆë‹¤ëŠ” ë§ì„ í–ˆì–´ìš”. ìì‹ ì˜ ì•„ì´ë””ì–´ë¥¼ í›”ì¹˜ë ¤ í•œë‹¤ê³ ..." ê·¸ì˜ ë§ì—ëŠ” ë¯¸ë¬˜í•œ ì§ˆíˆ¬ì‹¬ì´ ì„ì—¬ ìˆëŠ” ë“¯í–ˆë‹¤. ë‘ ì‚¬ëŒì˜ ì¦ì–¸ì€ ìƒë°˜ë˜ì—ˆê³ , ì‚¬ê±´ì€ ë”ìš± ë¯¸ê¶ ì†ìœ¼ë¡œ ë¹ ì ¸ë“¤ì—ˆë‹¤.` },
                { title: '2ì¥: ì–´ë‘  ì†ì˜ ì¡°ë ¥ì', dungeonToUnlock: 'ì˜¤í¬ ì ë ¹ì§€', content: `ìˆ˜ì‚¬ëŠ” ë‚œí•­ì— ë¶€ë”ªí˜”ë‹¤. ìš©ì˜ì„ ìƒì€ ë„“ì—ˆê³ , ë²”ì¸ì´ ë‚¨ê¸´ ë‹¨ì„œëŠ” êµë¬˜í•˜ê²Œ ì¡°ì‘ëœ ê²ƒë“¤ë¿ì´ì—ˆë‹¤. ì„œë„ì§„ê³¼ ë„ì²œì˜ì€ ë§‰ë‹¤ë¥¸ ê¸¸ì— ë‹¤ë‹¤ë¥¸ ë“¯í–ˆë‹¤. ê·¸ë•Œ, ì˜ë¬¸ì˜ ì „í™” í•œ í†µì´ ê±¸ë ¤ì™”ë‹¤. ìì‹ ì„ 'ì˜ì‚¬'ë¼ê³ ë§Œ ë°íŒ ëª©ì†Œë¦¬ëŠ” ë°•ë¯¼ì¤€ì˜ ì‹œì‹ ì—ì„œ ì¼ë°˜ì ì¸ ë…ê·¹ë¬¼ê³¼ëŠ” ë‹¤ë¥¸, íŠ¹ìˆ˜í•œ ì„±ë¶„ì´ ê²€ì¶œë˜ì—ˆë‹¤ëŠ” ì •ë³´ë¥¼ í˜ë ¸ë‹¤. ê·¸ë¦¬ê³  ê·¸ ì„±ë¶„ì„ ë§Œë“¤ ìˆ˜ ìˆëŠ” ì‚¬ëŒì€ ê·¹ì†Œìˆ˜ë¼ëŠ” ë§ê³¼ í•¨ê»˜ ë‚¡ì€ ì—°êµ¬ì†Œì˜ ì£¼ì†Œë¥¼ ë‚¨ê¸°ê³ ëŠ” ì „í™”ë¥¼ ëŠì—ˆë‹¤.[PAGE_BREAK]ë°˜ì‹ ë°˜ì˜í•˜ë©° ì°¾ì•„ê°„ ì—°êµ¬ì†ŒëŠ” íí—ˆë‚˜ ë‹¤ë¦„ì—†ì—ˆë‹¤. í•˜ì§€ë§Œ ê·¸ê³³ì—ì„œ ë‘ ì‚¬ëŒì€ ëœ»ë°–ì˜ ì¸ë¬¼ê³¼ ë§ˆì£¼ì¹œë‹¤. ìœ¤ì„œì²œ. í•œë•Œ ì´‰ë§ë°›ëŠ” í™”í•™ìì˜€ìœ¼ë‚˜, ë¹„ìœ¤ë¦¬ì ì¸ ì‹¤í—˜ìœ¼ë¡œ í•™ê³„ì—ì„œ í‡´ì¶œëœ ë‚¨ìì˜€ë‹¤. ê·¸ëŠ” íƒœì—°í•˜ê²Œ ë‘ ì‚¬ëŒì„ ë§ì´í•˜ë©°, ë°•ë¯¼ì¤€ì—ê²Œ ìì‹ ì´ ê°œë°œí•œ ì•½ë¬¼ì„ ì œê³µí•œ ê²ƒì€ ì‚¬ì‹¤ì´ì§€ë§Œ, ê·¸ê²ƒì€ ì‹ ê²½ ì•ˆì •ì œì˜€ì„ ë¿ì´ë¼ê³  ì£¼ì¥í–ˆë‹¤. ê·¸ì˜ ì—°êµ¬ì‹¤ì—ëŠ” ìˆ˜ë§ì€ ì‹¤í—˜ ë™ë¬¼ê³¼ ì •ì²´ë¶ˆëª…ì˜ ì•½í’ˆë“¤ì´ ê°€ë“í–ˆë‹¤. ì„œë„ì§„ì€ ê·¸ì˜ ëˆˆì—ì„œ ì§„ì‹¤ì„ ê°ˆë§í•˜ëŠ” ê´‘ê¸°ë¥¼ ë³´ì•˜ë‹¤. ê·¸ëŠ” ë¬´ì–¸ê°€ë¥¼ ìˆ¨ê¸°ê³  ìˆì—ˆë‹¤. 'ì˜ì‚¬'ëŠ” ëˆ„êµ¬ì´ë©°, ìœ¤ì„œì²œì€ ì´ ì‚¬ê±´ê³¼ ì–´ë–¤ ê´€ë ¨ì´ ìˆëŠ” ê±¸ê¹Œ. ë¯¸ìŠ¤í„°ë¦¬ëŠ” ë”ìš± ê¹Šì–´ë§Œ ê°”ë‹¤.` },
                { title: '3ì¥: ë§ˆì§€ë§‰ í¼ì¦', dungeonToUnlock: 'ìš©ì˜ ë‘¥ì§€', content: `ìœ¤ì„œì²œì˜ ì—°êµ¬ì‹¤ì—ì„œ ë‚˜ì˜¨ ë’¤, ì„œë„ì§„ì€ ê³„ì†í•´ì„œ ìœ„í™”ê°ì„ ëŠê¼ˆë‹¤. í˜„ì¥ì—ì„œ ë°œê²¬ëœ ë‹¨ì„œë“¤, ì˜ì‚¬ì˜ ì œë³´, ìœ¤ì„œì²œì˜ ì•Œë¦¬ë°”ì´. ëª¨ë“  ê²ƒì´ ë„ˆë¬´ë‚˜ë„ ì™„ë²½í•˜ê²Œ ë§ì•„ë–¨ì–´ì§€ëŠ” ê²ƒì´ ì˜¤íˆë ¤ ë¶€ìì—°ìŠ¤ëŸ¬ì› ë‹¤. ë§ˆì¹˜ ì˜ ì§œì¸ ê°ë³¸ì²˜ëŸ¼. ê·¸ëŠ” ì²˜ìŒë¶€í„° ëª¨ë“  ê²ƒì„ ë‹¤ì‹œ ë˜ì§šì–´ë³´ê¸° ì‹œì‘í–ˆë‹¤. ë°•ë¯¼ì¤€ì˜ ì†Œì„¤, í˜„ì¥ì˜ ì†Œí’ˆë“¤, ìš©ì˜ìë“¤ì˜ ì¦ì–¸. ëª¨ë“  ì¡°ê°ë“¤ì„ ë¨¸ë¦¿ì†ì—ì„œ ì¬êµ¬ì„±í•˜ë˜ ì„œë„ì§„ì˜ ëˆˆì— í•œ ê°€ì§€ ê°€ëŠ¥ì„±ì´ ìŠ¤ì³¤ë‹¤. ë§Œì•½, ë²”ì¸ì´ í•œ ëª…ì´ ì•„ë‹ˆë¼ë©´? ë§Œì•½, ì´ ëª¨ë“  ê²ƒì´ ëˆ„êµ°ê°€ë¥¼ ë²”ì¸ìœ¼ë¡œ ì§€ëª©í•˜ê¸° ìœ„í•œ ê±°ëŒ€í•œ ì—°ê·¹ì´ë¼ë©´?[PAGE_BREAK]ê·¸ ìˆœê°„, ë„ì²œì˜ì—ê²Œì„œ ì „í™”ê°€ ê±¸ë ¤ì™”ë‹¤. ë°•ë¯¼ì¤€ì˜ ìœ ì„œ í•„ì ì´, ê·¸ì˜ ë‹´ë‹¹ í¸ì§‘ìì˜€ë˜ ìœ¤í•„ê·œì˜ í•„ì ê³¼ ìƒë‹¹ ë¶€ë¶„ ì¼ì¹˜í•œë‹¤ëŠ” ê°ì • ê²°ê³¼ê°€ ë‚˜ì™”ë‹¤ëŠ” ê²ƒì´ë‹¤. ìœ¤í•„ê·œ. ì–¸ì œë‚˜ ë¬µë¬µíˆ ì„œë„ì§„ê³¼ ë°•ë¯¼ì¤€ì˜ ë’¤ì—ì„œ ê·¸ë“¤ì˜ ì‘í’ˆì„ ë„ì™”ë˜ ë‚¨ì. ê·¸ëŠ” ì–¸ì œë‚˜ ì¡°ìš©í–ˆê³ , ëˆˆì— ë„ì§€ ì•Šì•˜ë‹¤. í•˜ì§€ë§Œ ê·¸ë¬ê¸°ì—, ëª¨ë‘ë¥¼ ì†ì¼ ìˆ˜ ìˆì—ˆë‹¤. ì„œë„ì§„ì€ ê¹¨ë‹¬ì•˜ë‹¤. ì´ ë¹„ê·¹ì ì¸ ì†Œì„¤ì˜ ì§„ì •í•œ ì‘ê°€ëŠ”, ë°”ë¡œ ê°€ì¥ ê°€ê¹Œì´ì— ìˆì—ˆë˜ ê·¸ì˜€ìŒì„. ì´ì œ ë‚¨ì€ ê²ƒì€ ë§ˆì§€ë§‰ ì¥ì„ ë„˜ê¸°ëŠ” ê²ƒë¿ì´ì—ˆë‹¤. ì§„ì‹¤ì´ë¼ëŠ” ì´ë¦„ì˜, ì”í˜¹í•œ ê²°ë§ì„.` }
            ];

            const rarityProbabilities = { 'SSR': 3, 'SR': 12, 'R': 35, 'N': 50 };
            const eventRarityProbabilities = { 'SSR': 6, 'SR': 14, 'R': 30, 'N': 50 };
            const EVENT_CHARACTER_NAME = '[í•ë¹› ìš•ì¡°] ì„œë„ì§„';
            const EVENT_START_DATE = new Date('2025-10-14T00:00:00');
            const EVENT_END_DATE = new Date('2025-10-24T23:59:59');

            // --- ê²Œì„ ìƒíƒœ ---
            let playerCurrency = 100;
            let playerInventory = [];
            let playerDeck = [];
            let inventoryCapacity = 100;
            let representativeCharacter = null;
            let isCombatRunning = false;
            let combatSpeedMultiplier = 1;
            let lastCombatType = 'main'; // ë§ˆì§€ë§‰ ì „íˆ¬ ìœ í˜•ì„ ì €ì¥í•©ë‹ˆë‹¤.
            let clearedDungeons = [];
            let clearedEventDungeons = [];
            let playerEventPoints = 0;
            let purchasedEventItems = {};
            let currentStoryPages = [];
            let currentStoryPageIndex = 0;
            let playerBookmarks = 10;
            const MAX_BOOKMARKS = 10;
            let lastBookmarkUpdateTime = Date.now();
            const BOOKMARK_REGEN_TIME = 5 * 60 * 1000; // 5 minutes

            const DECK_CAPACITY = 5;
            const PULL_ONE_COST = 10;
            const PULL_TEN_COST = 100;
            const EXPAND_COST = 50;
            const EXPAND_AMOUNT = 10;
            const SAVE_DATA_KEY = 'gachaGameSaveData_v8';

            // --- HTML ìš”ì†Œ ê°€ì ¸ì˜¤ê¸° ---
            const currencyDisplay = document.getElementById('currency-display');
            const messageArea = document.getElementById('message-area');
            const allTabs = document.querySelectorAll('.tab-button');
            const allViews = document.querySelectorAll('main > div:not(#combat-result-modal):not(#card-detail-modal):not(#main-story-modal)');
            const pullOneButton = document.getElementById('pull-one');
            const pullTenButton = document.getElementById('pull-ten');
            const pullOneEventButton = document.getElementById('pull-one-event');
            const pullTenEventButton = document.getElementById('pull-ten-event');
            const resultsContainer = document.getElementById('results-container');
            const inventoryContainer = document.getElementById('inventory-container');
            const inventoryStatus = document.getElementById('inventory-status');
            const expandInventoryButton = document.getElementById('expand-inventory');
            const deckStatus = document.getElementById('deck-status');
            const deckSlotsContainer = document.getElementById('deck-slots-container');
            const deckInventoryContainer = document.getElementById('deck-inventory-container');
            const autoFillDeckButton = document.getElementById('auto-fill-deck');
            const deckPowerDisplay = document.getElementById('deck-power-display');
            const combatMessageArea = document.getElementById('combat-message-area');
            const dungeonListContainer = document.getElementById('dungeon-list-container');
            const homeCharacterContainer = document.getElementById('home-character-container');
            const homeCharacterImage = document.getElementById('home-character-image');
            const homeDialogueContainer = document.getElementById('home-dialogue-container');
            const homeDefaultMessage = document.getElementById('home-default-message');
            const homeCharacterName = document.getElementById('home-character-name');
            const homeCharacterDialogue = document.getElementById('home-character-dialogue');
            const eventBanner = document.getElementById('event-banner');
            const eventBannerText = document.getElementById('event-banner-text');
            const gachaTabNormal = document.getElementById('gacha-tab-normal');
            const gachaTabEvent = document.getElementById('gacha-tab-event');
            const normalGachaView = document.getElementById('normal-gacha-view');
            const eventGachaView = document.getElementById('event-gacha-view');
            const eventGachaInfo = document.getElementById('event-gacha-info');
            const resetButton = document.getElementById('reset-game');
            const storageWarning = document.getElementById('storage-warning');
            const combatInProgressView = document.getElementById('combat-in-progress-view');
            const combatPlayerDeck = document.getElementById('combat-player-deck');
            const combatMonsterArea = document.getElementById('combat-monster-area');
            const combatLogContainer = document.getElementById('combat-log-container');
            const combatLog = document.getElementById('combat-log');
            const combatResultModal = document.getElementById('combat-result-modal');
            const combatResultTitle = document.getElementById('combat-result-title');
            const combatResultMessage = document.getElementById('combat-result-message');
            const closeCombatResultButton = document.getElementById('close-combat-result');
            const cardDetailModal = document.getElementById('card-detail-modal');
            const closeCardDetailButton = document.getElementById('close-card-detail');
            const speed1xButton = document.getElementById('speed-1x');
            const speed2xButton = document.getElementById('speed-2x');
            const speed4xButton = document.getElementById('speed-4x');
            const collectionContainer = document.getElementById('collection-container');
            const mainStoryContainer = document.getElementById('main-story-container');
            const mainStoryModal = document.getElementById('main-story-modal');
            const closeMainStoryButton = document.getElementById('close-main-story');
            const detailStoryPrevButton = document.getElementById('detail-story-prev');
            const detailStoryNextButton = document.getElementById('detail-story-next');
            const mainStoryPrevButton = document.getElementById('main-story-prev');
            const mainStoryNextButton = document.getElementById('main-story-next');
            const eventTab = document.getElementById('tab-event');
            const eventPointDisplay = document.getElementById('event-point-display');
            const eventPointsSpan = document.getElementById('event-points');
            const eventSubTabBattle = document.getElementById('event-sub-tab-battle');
            const eventSubTabStory = document.getElementById('event-sub-tab-story');
            const eventSubTabShop = document.getElementById('event-sub-tab-shop');
            const eventBattleView = document.getElementById('event-battle-view');
            const eventStoryView = document.getElementById('event-story-view');
            const eventShopView = document.getElementById('event-shop-view');
            const eventDungeonListContainer = document.getElementById('event-dungeon-list-container');
            const eventStoryContainer = document.getElementById('event-story-container');
            const eventShopContainer = document.getElementById('event-shop-container');
            const bookmarkDisplay = document.getElementById('bookmark-display');
            const maxBookmarkDisplay = document.getElementById('max-bookmark-display');
            const bookmarkTimerContainer = document.getElementById('bookmark-timer-container'); 

            
            // --- ë°ì´í„° ì €ì¥/ë¶ˆëŸ¬ì˜¤ê¸° í•¨ìˆ˜ ---
            function isStorageAvailable() {
                try {
                    const key = "__test_localstorage__";
                    localStorage.setItem(key, key);
                    localStorage.removeItem(key);
                    return true;
                } catch (e) {
                    return false;
                }
            }

            function saveGame() {
                if (!isStorageAvailable()) return;
                const saveData = {
                    currency: playerCurrency,
                    inventory: playerInventory.map(card => card ? card.name : null).filter(Boolean),
                    deck: playerDeck.map(card => card ? card.name : null).filter(Boolean),
                    capacity: inventoryCapacity,
                    representative: representativeCharacter ? representativeCharacter.name : null,
                    clearedDungeons: clearedDungeons,
                    eventPoints: playerEventPoints,
                    clearedEventDungeons: clearedEventDungeons,
                    purchasedEventItems: purchasedEventItems,
                    bookmarks: playerBookmarks,
                    lastBookmarkUpdate: lastBookmarkUpdateTime,
                };
                localStorage.setItem(SAVE_DATA_KEY, JSON.stringify(saveData));
            }

            function loadGame() {
                if (!isStorageAvailable()) {
                    storageWarning.classList.remove('hidden');
                    resetButton.disabled = true;
                    playerInventory.push(findCharacter('[í¸ì§‘ì] ìœ¤í•„ê·œ'));
                    playerInventory.push(findCharacter('[ì¡°ìˆ˜] í•œ í˜„'));
                } else {
                    const savedDataString = localStorage.getItem(SAVE_DATA_KEY);
                    if (savedDataString) {
                        try {
                            const savedData = JSON.parse(savedDataString);
                            playerCurrency = savedData.currency ?? 100;
                            playerInventory = (savedData.inventory || []).map(name => findCharacter(name)).filter(Boolean);
                            playerDeck = (savedData.deck || []).map(name => findCharacter(name)).filter(Boolean);
                            inventoryCapacity = savedData.capacity ?? 100;
                            clearedDungeons = savedData.clearedDungeons || [];
                            playerEventPoints = savedData.eventPoints ?? 0;
                            clearedEventDungeons = savedData.clearedEventDungeons || [];
                            purchasedEventItems = savedData.purchasedEventItems || {};
                            playerBookmarks = savedData.bookmarks ?? MAX_BOOKMARKS;
                            lastBookmarkUpdateTime = savedData.lastBookmarkUpdate ?? Date.now();
                            if (savedData.representative) {
                                representativeCharacter = findCharacter(savedData.representative) || null;
                            }
                        } catch (e) {
                            console.error("ì €ì¥ëœ ë°ì´í„° íŒŒì‹± ì˜¤ë¥˜:", e);
                            initializeNewGameData();
                        }
                    } else {
                        initializeNewGameData();
                        saveGame();
                    }
                }
                calculateOfflineRegen();
                updateUI();
                checkEventStatus();
                switchTab('home');
            }

            function initializeNewGameData() {
                playerInventory.push(findCharacter('[í¸ì§‘ì] ìœ¤í•„ê·œ'));
                playerInventory.push(findCharacter('[ì¡°ìˆ˜] í•œ í˜„'));
                playerBookmarks = MAX_BOOKMARKS;
                lastBookmarkUpdateTime = Date.now();
            }


            function resetGame() {
                if (!isStorageAvailable()) return;
                if (resetButton.dataset.confirming === 'true') {
                    localStorage.removeItem(SAVE_DATA_KEY);
                    location.reload();
                } else {
                    resetButton.textContent = 'í™•ì¸?';
                    resetButton.dataset.confirming = 'true';
                    resetButton.classList.remove('bg-red-600', 'hover:bg-red-700');
                    resetButton.classList.add('bg-yellow-500', 'hover:bg-yellow-600');
                    setTimeout(() => {
                        resetButton.textContent = 'ì´ˆê¸°í™”';
                        resetButton.dataset.confirming = 'false';
                        resetButton.classList.remove('bg-yellow-500', 'hover:bg-yellow-600');
                        resetButton.classList.add('bg-red-600', 'hover:bg-red-700');
                    }, 3000);
                }
            }


            // --- í•µì‹¬ ê²Œì„ ë¡œì§ í•¨ìˆ˜ ---
            function switchTab(tabName) {
                if (isCombatRunning) return;
                allViews.forEach(view => view.classList.add('hidden'));
                allTabs.forEach(tab => tab.classList.remove('active'));
                document.getElementById(`${tabName}-view`).classList.remove('hidden');
                document.getElementById(`tab-${tabName}`).classList.add('active');
                if (tabName === 'home') displayHomeView();
                else if (tabName === 'inventory') displayInventory(); 
                else if (tabName === 'deck') displayDeckManagement();
                else if (tabName === 'combat') displayCombatView();
                else if (tabName === 'collection') displayCollection();
                else if (tabName === 'story') displayStoryView();
                else if (tabName === 'event') displayEventView();
            }
            
            function switchSubTab(viewContainer, button) {
                Array.from(viewContainer.children).forEach(view => {
                    if(view.id.endsWith('-view')) view.classList.add('hidden');
                });
                Array.from(button.parentElement.children).forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                const viewId = button.id.replace('sub-tab-', '') + '-view';
                const viewElement = document.getElementById(viewId);
                if (viewElement) {
                    viewElement.classList.remove('hidden');
                }
            }

            function switchGachaTab(tabName) {
                if (tabName === 'normal') {
                    normalGachaView.classList.remove('hidden');
                    eventGachaView.classList.add('hidden');
                    gachaTabNormal.classList.add('active');
                    gachaTabEvent.classList.remove('active');
                } else {
                    normalGachaView.classList.add('hidden');
                    eventGachaView.classList.remove('hidden');
                    gachaTabNormal.classList.remove('active');
                    gachaTabEvent.classList.add('active');
                }
            }

            function checkEventStatus() {
                const now = new Date();
                const isEventActive = true; // For testing: now >= EVENT_START_DATE && now <= EVENT_END_DATE;
                if (isEventActive) {
                    eventBanner.classList.remove('hidden');
                    eventBannerText.textContent = `${EVENT_CHARACTER_NAME} í™•ë¥  UP!`;
                    eventGachaInfo.querySelector('p').textContent = `[${EVENT_CHARACTER_NAME}] ë“±ì¥ í™•ë¥  UP!`;
                    gachaTabEvent.classList.remove('hidden');
                    eventTab.classList.remove('hidden');
                    eventPointDisplay.classList.remove('hidden');
                } else {
                    eventBanner.classList.add('hidden');
                    gachaTabEvent.classList.add('hidden');
                    eventTab.classList.add('hidden');
                    eventPointDisplay.classList.add('hidden');
                    if(gachaTabEvent.classList.contains('active')) {
                        switchGachaTab('normal');
                    }
                }
            }

            function displayHomeView(cycleDialogue = false) {
                if (representativeCharacter) {
                    homeCharacterContainer.classList.remove('hidden');
                    homeDialogueContainer.classList.remove('hidden');
                    homeDefaultMessage.classList.add('hidden');
                    homeCharacterImage.src = representativeCharacter.imageUrl;
                    homeCharacterName.textContent = representativeCharacter.name;
                    if (cycleDialogue) {
                        const currentDialogue = homeCharacterDialogue.textContent;
                        let newDialogue;
                        do {
                            newDialogue = representativeCharacter.dialogues[Math.floor(Math.random() * representativeCharacter.dialogues.length)];
                        } while (representativeCharacter.dialogues.length > 1 && newDialogue === currentDialogue);
                        homeCharacterDialogue.textContent = newDialogue;
                    } else {
                         homeCharacterDialogue.textContent = representativeCharacter.dialogues[0];
                    }
                } else {
                    homeCharacterContainer.classList.add('hidden');
                    homeDialogueContainer.classList.add('hidden');
                    homeDefaultMessage.classList.remove('hidden');
                }
            }
            
            function displayEventView() {
                displayEventBattleView();
                displayEventStoryView();
                displayEventShopView();
                switchSubTab(document.getElementById('event-view'), eventSubTabBattle);
            }

            function displayEventBattleView() {
                eventDungeonListContainer.innerHTML = '';
                eventDungeons.forEach((dungeon, index) => {
                    const isUnlocked = index === 0 || clearedEventDungeons.includes(eventDungeons[index - 1].name);
                    const isCleared = clearedEventDungeons.includes(dungeon.name);
                    const dungeonEl = document.createElement('button');
                    dungeonEl.className = `p-4 rounded-lg transition-colors duration-300 text-center ${isUnlocked ? 'bg-white/20 hover:bg-white/30 cursor-pointer' : 'bg-black/30 text-gray-500 cursor-not-allowed'}`;
                    dungeonEl.disabled = !isUnlocked;
                    
                    dungeonEl.innerHTML = `
                        <h3 class="text-xl font-bold ${isUnlocked ? 'text-yellow-300' : ''}">${dungeon.name}</h3>
                        <p class="text-sm">ë³´ìƒ: ${dungeon.eventPointReward} P ${isCleared ? '<span class="text-green-400">(í´ë¦¬ì–´)</span>' : ''}</p>
                    `;
                    if(isUnlocked){
                        dungeonEl.onclick = () => challengeDungeon(index, 'event');
                    }
                    eventDungeonListContainer.appendChild(dungeonEl);
                });
            }

            function displayEventStoryView() {
                eventStoryContainer.innerHTML = '';
                eventStories.forEach((story, index) => {
                    const isUnlocked = index === 0 || clearedEventDungeons.includes(eventDungeons[index - 1].name);
                    const storyEl = document.createElement('div');
                    storyEl.className = `p-4 rounded-lg transition-colors duration-300 ${isUnlocked ? 'bg-white/20 hover:bg-white/30 cursor-pointer' : 'bg-black/30 text-gray-500'}`;
                    if (isUnlocked) {
                        storyEl.dataset.storyIndex = index;
                        storyEl.dataset.storyType = 'event';
                    }

                    storyEl.innerHTML = `
                        <h3 class="text-xl font-bold ${isUnlocked ? 'text-yellow-300' : ''}">${story.title}</h3>
                        <p class="text-sm">${isUnlocked ? 'í´ë¦­í•˜ì—¬ ìŠ¤í† ë¦¬ ì½ê¸°' : `${eventDungeons[index-1].name} í´ë¦¬ì–´ ì‹œ í•´ê¸ˆ`}</p>
                    `;
                    eventStoryContainer.appendChild(storyEl);
                });
            }
            
            function displayEventShopView() {
                eventPointsSpan.textContent = playerEventPoints;
                eventShopContainer.innerHTML = '';
                eventShopItems.forEach(item => {
                    const purchasedCount = purchasedEventItems[item.id] || 0;
                    const isSoldOut = purchasedCount >= item.limit;
                    const canAfford = playerEventPoints >= item.cost;

                    const itemEl = document.createElement('div');
                    itemEl.className = 'bg-black/20 p-4 rounded-lg flex justify-between items-center';
                    itemEl.innerHTML = `
                        <div>
                            <h3 class="text-lg font-bold text-yellow-300">${item.name}</h3>
                            <p class="text-sm text-gray-300">ê°€ê²©: ${item.cost} P</p>
                            <p class="text-xs text-gray-400">ë‚¨ì€ íšŸìˆ˜: ${item.limit - purchasedCount} / ${item.limit}</p>
                        </div>
                        <button data-item-id="${item.id}" class="gacha-button bg-green-600 hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-2 px-4 rounded-full" ${isSoldOut || !canAfford ? 'disabled' : ''}>
                            ${isSoldOut ? 'í’ˆì ˆ' : 'êµ¬ë§¤'}
                        </button>
                    `;
                    eventShopContainer.appendChild(itemEl);
                });
            }
            
            function purchaseEventItem(itemId) {
                const item = eventShopItems.find(i => i.id === itemId);
                if (!item) return;

                const purchasedCount = purchasedEventItems[item.id] || 0;
                if (purchasedCount >= item.limit) {
                    showMessage('ì´ë¯¸ ìµœëŒ€ ìˆ˜ëŸ‰ì„ êµ¬ë§¤í–ˆìŠµë‹ˆë‹¤.', 'text-red-400', messageArea);
                    return;
                }
                if (playerEventPoints < item.cost) {
                    showMessage('ì´ë²¤íŠ¸ í¬ì¸íŠ¸ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤.', 'text-red-400', messageArea);
                    return;
                }

                playerEventPoints -= item.cost;
                purchasedEventItems[item.id] = purchasedCount + 1;

                if (item.type === 'card') {
                    playerInventory.push(item.itemData);
                    showMessage(`[${item.name}] íšë“!`, 'text-green-300', messageArea);
                } else if (item.type === 'currency') {
                    playerCurrency += item.itemData;
                    showMessage(`ë³´ì„ ${item.itemData}ê°œ íšë“!`, 'text-green-300', messageArea);
                }

                updateUI();
                displayEventShopView();
                saveGame();
            }

            function calculateOfflineRegen() {
                if (playerBookmarks >= MAX_BOOKMARKS) {
                    lastBookmarkUpdateTime = Date.now();
                    return;
                }
                const now = Date.now();
                const timeDiff = now - lastBookmarkUpdateTime;
                const bookmarksToRegen = Math.floor(timeDiff / BOOKMARK_REGEN_TIME);

                if (bookmarksToRegen > 0) {
                    playerBookmarks = Math.min(MAX_BOOKMARKS, playerBookmarks + bookmarksToRegen);
                    lastBookmarkUpdateTime = lastBookmarkUpdateTime + bookmarksToRegen * BOOKMARK_REGEN_TIME;
                    saveGame();
                }
            }

            function startBookmarkRegenTimer() {
                setInterval(() => {
                    // ì´ ë¸”ë¡ì€ ì±…ê°ˆí”¼ê°€ ì‹¤ì œë¡œ ì¶©ì „ë˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.
                    if (playerBookmarks < MAX_BOOKMARKS) {
                        const now = Date.now();
                        if (now - lastBookmarkUpdateTime >= BOOKMARK_REGEN_TIME) {
                            playerBookmarks++;
                            lastBookmarkUpdateTime = now; // íƒ€ì´ë¨¸ë¥¼ í˜„ì¬ ì‹œê°„ìœ¼ë¡œ ì´ˆê¸°í™”í•©ë‹ˆë‹¤.
                            updateUI();
                            saveGame();
                        }
                    }

                    // ì´ ë¸”ë¡ì€ ë‚¨ì€ ì‹œê°„ì„ í™”ë©´ì— í‘œì‹œí•˜ëŠ” ë¡œì§ì…ë‹ˆë‹¤.
                    if (playerBookmarks < MAX_BOOKMARKS) {
                        const timeRemaining = BOOKMARK_REGEN_TIME - (Date.now() - lastBookmarkUpdateTime);
                        const minutes = Math.floor(timeRemaining / 60000);
                        const seconds = Math.floor((timeRemaining % 60000) / 1000);
                        
                        // MM:SS í˜•ì‹ìœ¼ë¡œ í‘œì‹œí•©ë‹ˆë‹¤. (ì˜ˆ: 04:32)
                        bookmarkTimerContainer.textContent = `(${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')})`;
                        bookmarkTimerContainer.classList.remove('hidden');
                    } else {
                        // ì±…ê°ˆí”¼ê°€ ê°€ë“ ì°¨ë©´ íƒ€ì´ë¨¸ë¥¼ ìˆ¨ê¹ë‹ˆë‹¤.
                        bookmarkTimerContainer.classList.add('hidden');
                    }
                }, 1000); // 1ì´ˆë§ˆë‹¤ ë°˜ë³µ
            }


            function setRepresentative(cardName) {
                const cardData = findCharacter(cardName);
                if (cardData) {
                    representativeCharacter = cardData;
                    showMessage(`${cardData.name}(ì„)ë¥¼ ëŒ€í‘œë¡œ ì„¤ì •í–ˆìŠµë‹ˆë‹¤!`, 'text-blue-300', messageArea);
                    displayInventory();
                    saveGame();
                }
            }
            
            function handlePull(count, cost, gachaType = 'normal') {
                if (playerInventory.length + count > inventoryCapacity) {
                    showMessage('ë³´ê´€í•¨ ê³µê°„ì´ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'text-yellow-400', messageArea); return;
                }
                if (playerCurrency >= cost) {
                    playerCurrency -= cost;
                    showMessage(`-ğŸ’${cost}`, 'text-red-400', messageArea);
                    performPulls(count, gachaType);
                } else {
                    showMessage('ì¬í™”ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'text-red-400', messageArea);
                }
            }
            
            function expandInventory() {
                if (playerCurrency >= EXPAND_COST) {
                    playerCurrency -= EXPAND_COST; inventoryCapacity += EXPAND_AMOUNT;
                    showMessage(`ë³´ê´€í•¨ì´ ${inventoryCapacity}ì¹¸ìœ¼ë¡œ í™•ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'text-green-300', messageArea);
                    updateUI(); displayInventory(); saveGame();
                } else {
                    showMessage('ë³´ì„ì´ ë¶€ì¡±í•˜ì—¬ í™•ì¥í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.', 'text-red-400', messageArea);
                }
            }

            function updateUI() {
                currencyDisplay.textContent = playerCurrency;
                eventPointsSpan.textContent = playerEventPoints;
                bookmarkDisplay.textContent = playerBookmarks;
                maxBookmarkDisplay.textContent = MAX_BOOKMARKS;

                const buttons = [pullOneButton, pullTenButton, pullOneEventButton, pullTenEventButton];
                buttons.forEach(btn => {
                    if (btn.id.includes('ten')) btn.disabled = playerCurrency < PULL_TEN_COST;
                    else btn.disabled = playerCurrency < PULL_ONE_COST;
                });
                expandInventoryButton.disabled = playerCurrency < EXPAND_COST;
            }

            function showMessage(message, colorClass, element) {
                element.textContent = message;
                element.className = `text-center text-lg h-8 mb-4 transition-opacity duration-300 ${colorClass}`;
                setTimeout(() => { element.textContent = ''; }, 2000);
            }

            function performPulls(count, gachaType = 'normal') {
                const results = [];
                let guaranteedSR = (count === 10);
                for (let i = 0; i < count; i++) {
                    let pulledChar;
                    if (guaranteedSR && i === count - 1 && !results.some(c => c.rarity === 'SR' || c.rarity === 'SSR')) {
                        pulledChar = pullCharacter(['SR', 'SSR'], gachaType);
                    } else {
                        pulledChar = pullCharacter(null, gachaType);
                    }
                    results.push(pulledChar);
                    playerInventory.push(pulledChar); 
                }
                displayResults(results); updateUI(); saveGame();
            }

            function pullCharacter(allowedRarities = null, gachaType = 'normal') {
                const now = new Date();
                const isEventActive = true; // For testing
                const useEventRates = gachaType === 'event' && isEventActive;
                const probabilities = useEventRates ? eventRarityProbabilities : rarityProbabilities;
                
                let selectedRarity = '';
                if (allowedRarities) {
                    const highTierProb = { 'SSR': probabilities['SSR'], 'SR': probabilities['SR'] };
                    const totalProb = highTierProb.SSR + highTierProb.SR;
                    selectedRarity = (Math.random() * totalProb < highTierProb.SSR) ? 'SSR' : 'SR';
                } else {
                    const rand = Math.random() * 100; let cumulativeProb = 0;
                    for (const rarity in probabilities) {
                        cumulativeProb += probabilities[rarity];
                        if (rand < cumulativeProb) { selectedRarity = rarity; break; }
                    }
                }

                if (useEventRates && (selectedRarity === 'SSR' || selectedRarity === 'SR')) {
                    if (Math.random() < 0.5) { // 50% chance for event character
                        return characters.find(c => c.name === EVENT_CHARACTER_NAME);
                    } else {
                        const otherChars = characters.filter(c => c.rarity === selectedRarity && c.name !== EVENT_CHARACTER_NAME);
                        if (otherChars.length > 0) return otherChars[Math.floor(Math.random() * otherChars.length)];
                        return characters.find(c => c.name === EVENT_CHARACTER_NAME); // Fallback
                    }
                }

                const possibleCharacters = characters.filter(char => char.rarity === selectedRarity);
                return possibleCharacters[Math.floor(Math.random() * possibleCharacters.length)];
            }

            function displayResults(pulledCharacters) {
                resultsContainer.innerHTML = '';
                pulledCharacters.forEach((character, index) => {
                    resultsContainer.appendChild(createCard(character, { animationIndex: index, mode: 'gachaResult' }));
                });
            }
            
            function getUniqueInventory() {
                const cardCounts = playerInventory.reduce((acc, card) => {
                    if (card && card.name) {
                        if (!acc[card.name]) { acc[card.name] = { ...card, count: 0 }; }
                        acc[card.name].count++;
                    }
                    return acc;
                }, {});
                const rarityOrder = { 'SSR': 4, 'SR': 3, 'R': 2, 'N': 1 };
                return Object.values(cardCounts).sort((a, b) => (rarityOrder[b.rarity] - rarityOrder[a.rarity]) || a.name.localeCompare(b.name));
            }

            function displayInventory() {
                inventoryStatus.textContent = `${playerInventory.length} / ${inventoryCapacity}`;
                inventoryContainer.innerHTML = '';
                const uniqueCards = getUniqueInventory();
                if (uniqueCards.length === 0) {
                    inventoryContainer.innerHTML = `<p class="col-span-full text-center text-gray-400 mt-10">ì•„ì§ ìˆ˜ì§‘í•œ ë™ë£Œê°€ ì—†ìŠµë‹ˆë‹¤.</p>`; return;
                }
                uniqueCards.forEach((character, index) => {
                    inventoryContainer.appendChild(createCard(character, { animationIndex: index, mode: 'inventory' }));
                });
            }

            function displayCollection() {
                collectionContainer.innerHTML = '';
                const collectedCardNames = new Set(playerInventory.map(card => card.name));

                characters.forEach((character, index) => {
                    const isCollected = collectedCardNames.has(character.name);
                    collectionContainer.appendChild(createCard(character, {
                        animationIndex: index,
                        mode: 'collection',
                        isCollected: isCollected
                    }));
                });
            }


            function displayDeckManagement() {
                deckStatus.textContent = `í˜„ì¬ ë±: ${playerDeck.length} / ${DECK_CAPACITY}`;
                deckStatus.classList.toggle('text-green-400', playerDeck.length === DECK_CAPACITY);
                deckSlotsContainer.innerHTML = '';
                for (let i = 0; i < DECK_CAPACITY; i++) {
                    if (playerDeck[i]) {
                        deckSlotsContainer.appendChild(createCard(playerDeck[i], { mode: 'deckSlot' }));
                    } else {
                        const emptySlot = document.createElement('div');
                        emptySlot.className = 'deck-slot rounded-lg'; emptySlot.textContent = 'ë¹„ì–´ìˆìŒ';
                        deckSlotsContainer.appendChild(emptySlot);
                    }
                }
                deckInventoryContainer.innerHTML = '';
                const uniqueCards = getUniqueInventory();
                 if (uniqueCards.length === 0) {
                    deckInventoryContainer.innerHTML = `<p class="col-span-full text-center text-gray-400 mt-10">ë±ì— ì¶”ê°€í•  ì¹´ë“œê°€ ì—†ìŠµë‹ˆë‹¤.</p>`; return;
                }
                uniqueCards.forEach((character, index) => {
                    const isCardInDeck = playerDeck.some(deckCard => deckCard.name === character.name);
                    const isDeckFull = playerDeck.length >= DECK_CAPACITY;
                    deckInventoryContainer.appendChild(createCard(character, { animationIndex: index, mode: 'deckBuilder', isCardInDeck, isDeckFull }));
                });
            }
            
            function autoFillDeck() {
                const uniqueCards = getUniqueInventory();
                const sortedByPower = uniqueCards.sort((a, b) => (b.stats.atk + b.stats.def) - (a.stats.atk + a.stats.def));
                playerDeck = sortedByPower.slice(0, DECK_CAPACITY);
                displayDeckManagement();
                showMessage('ê°€ì¥ ê°•ë ¥í•œ ì¹´ë“œë¡œ ë±ì„ ìë™ í¸ì„±í–ˆìŠµë‹ˆë‹¤!', 'text-blue-300', messageArea);
                saveGame();
            }

            function addToDeck(cardName) {
                if (playerDeck.length >= DECK_CAPACITY || playerDeck.some(card => card.name === cardName)) return;
                const cardToAdd = findCharacter(cardName);
                if (cardToAdd) { playerDeck.push(cardToAdd); displayDeckManagement(); saveGame(); }
            }
            
            function removeFromDeck(cardName) {
                const indexToRemove = playerDeck.findIndex(card => card.name === cardName);
                if(indexToRemove > -1) {
                    playerDeck.splice(indexToRemove, 1);
                }
                displayDeckManagement();
                saveGame();
            }
            
            function calculateDeckPower() {
                return playerDeck.reduce((total, card) => total + (card.stats.atk + card.stats.def + Math.floor(card.stats.hp / 10)), 0);
            }

            function displayCombatView() {
                deckPowerDisplay.textContent = calculateDeckPower();
                dungeonListContainer.innerHTML = '';
                dungeons.forEach((dungeon, index) => {
                    const monster = monsters[dungeon.monsterName];
                    const recommendedPower = monster.stats.atk*5 + monster.stats.def*5 + Math.floor(monster.stats.hp / 5);
                    const dungeonEl = document.createElement('div');
                    dungeonEl.className = 'bg-black/20 p-4 rounded-lg text-center';
                    dungeonEl.innerHTML = `
                        <h3 class="text-xl font-bold text-yellow-300">${dungeon.name}</h3>
                        <p class="text-gray-300">ê¶Œì¥ ì „íˆ¬ë ¥: ${recommendedPower}</p>
                        <p class="text-gray-300">ì˜ˆìƒ ë³´ìƒ: ğŸ’${dungeon.rewards.min} ~ ${dungeon.rewards.max}</p>
                        <button data-action="challenge-dungeon" data-dungeon-index="${index}" class="gacha-button bg-red-600 hover:bg-red-700 text-white font-bold py-2 px-6 rounded-full mt-4">ë„ì „</button>
                    `;
                    dungeonListContainer.appendChild(dungeonEl);
                });
            }
            
            function challengeDungeon(dungeonIndex, type = 'main') {
                if (playerBookmarks < 1) {
                    const msgArea = type === 'event' ? document.getElementById('message-area') : (document.getElementById('combat-message-area') || messageArea);
                    showMessage('ì±…ê°ˆí”¼ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤!', 'text-yellow-400', msgArea);
                    return;
                }
                if (playerDeck.length < DECK_CAPACITY) {
                    const msgArea = type === 'event' ? document.getElementById('message-area') : (document.getElementById('combat-message-area') || messageArea);
                    showMessage('ë±ì„ 5ì¥ìœ¼ë¡œ ëª¨ë‘ ì±„ì›Œì•¼ í•©ë‹ˆë‹¤!', 'text-yellow-400', msgArea);
                    return;
                }
                
                playerBookmarks--;
                if (playerBookmarks === MAX_BOOKMARKS - 1) {
                     lastBookmarkUpdateTime = Date.now();
                }
                updateUI();
                // saveGame(); // ì „íˆ¬ ì‹œì‘ ì „ì— ì €ì¥í•˜ì§€ ì•Šê³ , ì „íˆ¬ ì¢…ë£Œ í›„ì— ì €ì¥.

                startCombat(dungeonIndex, type);
            }

            function setCombatSpeed(speed) {
                combatSpeedMultiplier = speed;
                const allSpeedButtons = document.querySelectorAll('.speed-button');
                allSpeedButtons.forEach(btn => {
                    btn.classList.remove('active');
                    btn.classList.add('bg-gray-600');
                    btn.classList.remove('bg-blue-500');
                });
                document.getElementById(`speed-${speed}x`).classList.add('active', 'bg-blue-500');
                document.getElementById(`speed-${speed}x`).classList.remove('bg-gray-600');
            }

            async function startCombat(dungeonIndex, type) {
                isCombatRunning = true;
                setCombatSpeed(1); // ì „íˆ¬ ì‹œì‘ ì‹œ 1ë°°ì†ìœ¼ë¡œ ì´ˆê¸°í™”
                const dungeonList = type === 'event' ? eventDungeons : dungeons;
                const dungeon = dungeonList[dungeonIndex];
                const monsterData = JSON.parse(JSON.stringify(monsters[dungeon.monsterName]));
                const combatDeck = JSON.parse(JSON.stringify(playerDeck));

                allViews.forEach(view => view.classList.add('hidden'));
                combatInProgressView.classList.remove('hidden');
                combatLog.innerHTML = '';
                combatPlayerDeck.innerHTML = '';
                combatDeck.forEach((card, index) => {
                    const cardEl = document.createElement('div');
                    cardEl.className = 'bg-gray-700 p-2 rounded';
                    cardEl.innerHTML = `
                        <p class="font-bold text-sm truncate" title="${card.name}">${card.name}</p>
                        <div class="hp-bar-background rounded-full h-2.5 mt-1">
                            <div id="player-hp-bar-${index}" class="hp-bar-foreground h-2.5 rounded-full" style="width: 100%"></div>
                        </div>
                        <p id="player-hp-text-${index}" class="text-xs text-center mt-0.5">${card.stats.hp} / ${card.stats.hp}</p>
                    `;
                    combatPlayerDeck.appendChild(cardEl);
                });

                combatMonsterArea.innerHTML = `
                    <h3 class="text-2xl font-bold">${monsterData.name}</h3>
                    <img id="combat-monster-image" src="${monsterData.imageUrl}" alt="${monsterData.name}" class="my-4 h-48 w-48 object-contain">
                    <div class="w-full hp-bar-background rounded-full h-4">
                        <div id="monster-hp-bar" class="hp-bar-foreground h-4 rounded-full" style="width: 100%"></div>
                    </div>
                    <p id="monster-hp-text" class="text-sm mt-1">${monsterData.stats.hp} / ${monsterData.stats.hp}</p>
                `;
                
                await runCombatLoop(combatDeck, monsterData, dungeon, type);
            }

            const delay = ms => new Promise(res => setTimeout(res, ms / combatSpeedMultiplier));

            async function runCombatLoop(combatDeck, monsterData, dungeon, type) {
                const originalMonsterDef = monsterData.stats.def;

                while (monsterData.stats.hp > 0 && combatDeck.some(c => c.stats.hp > 0)) {
                    for (let i = 0; i < combatDeck.length; i++) {
                        const card = combatDeck[i];
                        if (card.stats.hp > 0) {
                            await delay(800);
                            const monsterImage = document.getElementById('combat-monster-image');
                            
                            const useUltimate = card.rarity === 'SSR' && Math.random() < 0.25;
                            const useSkill = Math.random() < 0.4;
                            let skillToUse = null;

                            if (useUltimate && card.skills.length > 1) skillToUse = card.skills[1];
                            else if (useSkill) skillToUse = card.skills[0];

                            let damage = 0;
                            if (skillToUse) {
                                logCombat(`<strong>${card.name}</strong>ì˜ ìŠ¤í‚¬! <span class="text-yellow-300">"${skillToUse.name}"</span>`);
                                await delay(400);
                                logCombat(`<em>"${skillToUse.dialogue}"</em>`);
                                
                                damage = Math.max(1, Math.floor(card.stats.atk * skillToUse.power) - monsterData.stats.def);
                                
                                if (skillToUse.type === 'vampire') {
                                    const healedAmount = Math.floor(damage * 0.5);
                                    const originalCardData = playerDeck[i];
                                    card.stats.hp = Math.min(originalCardData.stats.hp, card.stats.hp + healedAmount);
                                    logCombat(`<strong>${card.name}</strong>ì´(ê°€) ${healedAmount}ì˜ ì²´ë ¥ì„ íšŒë³µí–ˆë‹¤!`);
                                }
                                if (skillToUse.type === 'debuff_def') {
                                    monsterData.stats.def = Math.max(0, Math.floor(monsterData.stats.def * 0.8));
                                    logCombat(`<strong>${monsterData.name}</strong>ì˜ ë°©ì–´ë ¥ì´ ê°ì†Œí–ˆë‹¤!`);
                                }

                            } else {
                                logCombat(`<strong>${card.name}</strong>ì˜ ì¼ë°˜ ê³µê²©!`);
                                damage = Math.max(1, card.stats.atk - monsterData.stats.def);
                            }
                            
                            monsterData.stats.hp = Math.max(0, monsterData.stats.hp - damage);
                            logCombat(`<strong>${monsterData.name}</strong>ì—ê²Œ ${damage}ì˜ ë°ë¯¸ì§€!`);
                            monsterImage.classList.add('shake-animation');
                            updateCombatUI(combatDeck, monsterData);
                            setTimeout(() => monsterImage.classList.remove('shake-animation'), 300 / combatSpeedMultiplier);

                            if (monsterData.stats.hp <= 0) break;
                        }
                    }
                    if (monsterData.stats.hp <= 0) break;

                    await delay(1000);
                    const alivePlayers = combatDeck.filter(c => c.stats.hp > 0);
                    if (alivePlayers.length > 0) {
                        const targetCard = alivePlayers[Math.floor(Math.random() * alivePlayers.length)];
                        logCombat(`<strong>${monsterData.name}</strong>ì˜ ê³µê²©!`);
                        const damage = Math.max(1, monsterData.stats.atk - targetCard.stats.def);
                        const hpBeforeAttack = targetCard.stats.hp;
                        targetCard.stats.hp = Math.max(0, targetCard.stats.hp - damage);
                        logCombat(`<strong>${targetCard.name}</strong>ì—ê²Œ ${damage}ì˜ ë°ë¯¸ì§€!`);
                        
                        if (targetCard.stats.hp <= 0 && hpBeforeAttack > 0) {
                            await delay(400);
                            logCombat(`<strong>${targetCard.name}</strong>: <em>"${targetCard.deathDialogue}"</em>`);
                        }

                        updateCombatUI(combatDeck, monsterData);
                    }
                }
                
                await delay(1000);
                monsterData.stats.def = originalMonsterDef;
                endCombat(monsterData.stats.hp <= 0, dungeon, type);
            }

            function logCombat(message) {
                combatLog.innerHTML += `<p>${message}</p>`;
                combatLogContainer.scrollTop = combatLogContainer.scrollHeight;
            }

            function updateCombatUI(deck, monster) {
                deck.forEach((card, index) => {
                    const originalCard = playerDeck.find(c => c.name === card.name);
                    if(!originalCard) return;
                    const maxHp = originalCard.stats.hp;
                    const currentHp = card.stats.hp;
                    const hpPercent = (currentHp / maxHp) * 100;
                    document.getElementById(`player-hp-bar-${index}`).style.width = `${hpPercent}%`;
                    document.getElementById(`player-hp-text-${index}`).textContent = `${currentHp} / ${maxHp}`;
                });

                const monsterMaxHp = monsters[monster.name].stats.hp;
                const monsterHpPercent = (monster.stats.hp / monsterMaxHp) * 100;
                document.getElementById('monster-hp-bar').style.width = `${monsterHpPercent}%`;
                document.getElementById('monster-hp-text').textContent = `${monster.stats.hp} / ${monsterMaxHp}`;
            }
            
            function endCombat(isVictory, dungeon, type) {
                lastCombatType = type; // í˜„ì¬ ì¢…ë£Œëœ ì „íˆ¬ ìœ í˜•ì„ ì €ì¥í•©ë‹ˆë‹¤.
                if (isVictory) {
                    let rewardMsg = '';
                    if(type === 'event') {
                        const reward = dungeon.eventPointReward;
                        playerEventPoints += reward;
                        if (!clearedEventDungeons.includes(dungeon.name)) {
                            clearedEventDungeons.push(dungeon.name);
                        }
                        rewardMsg = `ì´ë²¤íŠ¸ ìŠ¤í…Œì´ì§€ í´ë¦¬ì–´! ${reward} Pë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤.`;
                    } else {
                        if (!clearedDungeons.includes(dungeon.name)) {
                            clearedDungeons.push(dungeon.name);
                        }
                        const earnedReward = dungeon.rewards.min + Math.floor(Math.random() * (dungeon.rewards.max - dungeon.rewards.min + 1));
                        playerCurrency += earnedReward;
                        rewardMsg = `ë˜ì „ í´ë¦¬ì–´! ğŸ’${earnedReward}ë¥¼ íšë“í–ˆìŠµë‹ˆë‹¤.`;
                    }
                    combatResultTitle.textContent = "ìŠ¹ë¦¬!";
                    combatResultTitle.className = "text-4xl font-bold mb-4 text-green-400";
                    combatResultMessage.textContent = rewardMsg;
                } else {
                    combatResultTitle.textContent = "íŒ¨ë°°...";
                    combatResultTitle.className = "text-4xl font-bold mb-4 text-red-400";
                    combatResultMessage.textContent = `ì „íˆ¬ì—ì„œ íŒ¨ë°°í–ˆìŠµë‹ˆë‹¤...`;
                }
                
                updateUI();
                saveGame();
                combatResultModal.classList.remove('hidden');
                isCombatRunning = false;
            }

            function createCard(character, options = {}) {
                const { animationIndex, mode = 'default', isCardInDeck, isDeckFull, isCollected } = options;
                const card = document.createElement('div');
                card.className = `rarity-${character.rarity} relative text-center rounded-lg shadow-md p-2 transform transition-transform duration-300 hover:scale-105 cursor-pointer`;
                card.dataset.cardName = character.name;
                card.title = character.name;
                const rarityColor = { 'N': 'text-gray-600', 'R': 'text-blue-800', 'SR': 'text-white', 'SSR': 'text-black' }[character.rarity];
                const factionColors = {
                    'íƒì •': 'bg-blue-500 text-white',
                    'ì¡°ìˆ˜': 'bg-green-500 text-white',
                    'ë²”ì¸': 'bg-red-500 text-white'
                };
                
                let badgeHTML = '';
                if(mode === 'inventory' && character.count > 1) {
                    badgeHTML = `<div class="count-badge">x${character.count}</div>`;
                }

                let actionButtonsHTML = '';
                if (mode === 'deckBuilder') {
                    const disabled = isDeckFull || isCardInDeck;
                    const buttonText = isCardInDeck ? 'ì¶”ê°€ë¨' : 'ì¶”ê°€';
                    const buttonColor = disabled ? 'bg-gray-500' : 'bg-green-500 hover:bg-green-600';
                    actionButtonsHTML = `<button data-action="add-to-deck" data-card-name="${character.name}" class="w-full mt-2 py-1 rounded-md text-white font-bold text-sm ${buttonColor}" ${disabled ? 'disabled' : ''}>${buttonText}</button>`;
                } else if (mode === 'inventory') {
                    const isRepresentative = representativeCharacter && representativeCharacter.name === character.name;
                    const repButtonText = isRepresentative ? 'ëŒ€í‘œ' : 'ëŒ€í‘œ ì„¤ì •';
                    const repButtonColor = isRepresentative ? 'bg-yellow-500' : 'bg-gray-600 hover:bg-gray-700';
                    actionButtonsHTML = `<button data-action="set-representative" data-card-name="${character.name}" class="w-full mt-2 py-1 rounded-md text-white font-bold text-sm ${repButtonColor}" ${isRepresentative ? 'disabled' : ''}>${repButtonText}</button>`;
                }
                
                let deckSlotButton = '';
                if(mode === 'deckSlot') {
                    deckSlotButton = `<button data-action="remove-from-deck" data-card-name="${character.name}" class="absolute top-1 right-1 bg-red-600 text-white rounded-full w-6 h-6 text-sm font-bold flex items-center justify-center z-10">X</button>`;
                }

                const factionBadge = `<span class="absolute top-2 right-2 text-xs font-bold px-2 py-1 rounded-full ${factionColors[character.faction]} z-10">${character.faction}</span>`;

                card.innerHTML = `
                    ${badgeHTML} ${deckSlotButton} ${factionBadge}
                    <div class="relative pointer-events-none">
                        <img src="${character.cardImageUrl}" alt="${character.name}" class="w-full h-auto rounded-md mb-2 border-2 border-white/50">
                        <p class="font-bold text-sm ${rarityColor} truncate">${character.name}</p>
                        <p class="font-black text-lg ${rarityColor}" style="text-shadow: 1px 1px 2px rgba(255,255,255,0.5);">${character.rarity}</p>
                    </div>
                     ${actionButtonsHTML}
                `;
                if (typeof animationIndex === 'number') {
                    card.style.opacity = '0';
                    card.style.animationDelay = `${animationIndex * 0.05}s`;
                    card.classList.add('card-animation');
                }
                if(mode === 'deckBuilder' && isCardInDeck) {
                    card.classList.add('opacity-50');
                }
                if (mode === 'collection') {
                    if (isCollected) {
                        card.dataset.isCollected = "true";
                    } else {
                        card.dataset.isCollected = "false";
                        card.classList.add('grayscale', 'opacity-75');
                        card.classList.remove('hover:scale-105', 'cursor-pointer');
                    }
                }
                return card;
            }

            function getSkillDescription(skill) {
                switch(skill.type) {
                    case 'damage': return `ê³µê²©ë ¥ì˜ ${skill.power * 100}% ë§Œí¼ í”¼í•´ë¥¼ ì¤ë‹ˆë‹¤.`;
                    case 'debuff_def': return `ì ì˜ ë°©ì–´ë ¥ì„ ì¼ì‹œì ìœ¼ë¡œ ê°ì†Œì‹œí‚µë‹ˆë‹¤.`;
                    case 'vampire': return `ê°€í•œ í”¼í•´ì˜ 50% ë§Œí¼ ì²´ë ¥ì„ íšŒë³µí•©ë‹ˆë‹¤.`;
                    default: return 'íŠ¹ë³„í•œ íš¨ê³¼ë¥¼ ê°€ì§„ ìŠ¤í‚¬ì…ë‹ˆë‹¤.';
                }
            }

            function showCardDetails(cardName) {
                const character = findCharacter(cardName);
                if (!character) return;

                document.getElementById('detail-card-image').src = character.imageUrl;
                document.getElementById('detail-card-name').textContent = character.name;
                const rarityEl = document.getElementById('detail-card-rarity');
                rarityEl.textContent = character.rarity;
                const rarityColor = { 'N': 'text-gray-400', 'R': 'text-blue-400', 'SR': 'text-purple-400', 'SSR': 'text-yellow-400' }[character.rarity];
                rarityEl.className = `font-bold text-2xl ${rarityColor}`;

                const factionEl = document.getElementById('detail-card-faction');
                factionEl.textContent = character.faction;
                const factionColors = {
                    'íƒì •': 'bg-blue-500 text-white',
                    'ì¡°ìˆ˜': 'bg-green-500 text-white',
                    'ë²”ì¸': 'bg-red-500 text-white'
                };
                factionEl.className = `font-bold text-lg px-3 py-1 rounded-full ${factionColors[character.faction]}`;


                document.getElementById('detail-stat-hp').textContent = character.stats.hp;
                document.getElementById('detail-stat-atk').textContent = character.stats.atk;
                document.getElementById('detail-stat-def').textContent = character.stats.def;

                const skillsContainer = document.getElementById('detail-skills-container');
                skillsContainer.innerHTML = '';
                character.skills.forEach((skill, index) => {
                    const isUltimate = character.rarity === 'SSR' && index === 1;
                    const skillEl = document.createElement('div');
                    skillEl.className = 'bg-black/20 p-3 rounded-lg';
                    skillEl.innerHTML = `
                        <h4 class="font-bold ${isUltimate ? 'text-yellow-300' : 'text-white'}">${isUltimate ? 'ê¶ê·¹ê¸°' : 'ì¼ë°˜ ìŠ¤í‚¬'}: ${skill.name}</h4>
                        <p class="text-gray-300 italic">"${skill.dialogue}"</p>
                        <p class="text-sm mt-1">${getSkillDescription(skill)}</p>
                    `;
                    skillsContainer.appendChild(skillEl);
                });
                
                currentStoryPages = character.story.split('[PAGE_BREAK]');
                currentStoryPageIndex = 0;
                displayCardStoryPage();
                
                cardDetailModal.classList.remove('hidden');
            }
            
            function displayCardStoryPage() {
                const storyContent = document.getElementById('detail-card-story');
                const pageIndicator = document.getElementById('detail-story-page-indicator');
                
                storyContent.textContent = currentStoryPages[currentStoryPageIndex];
                pageIndicator.textContent = `${currentStoryPageIndex + 1} / ${currentStoryPages.length}`;
                
                detailStoryPrevButton.disabled = currentStoryPageIndex === 0;
                detailStoryNextButton.disabled = currentStoryPageIndex === currentStoryPages.length - 1;
            }

            function hideCardDetails() {
                cardDetailModal.classList.add('hidden');
            }
            
            function findCharacter(name) {
                return characters.find(c => c.name === name);
            }

            function displayStoryView() {
                mainStoryContainer.innerHTML = '';
                mainStories.forEach((story, index) => {
                    const isUnlocked = story.dungeonToUnlock === null || clearedDungeons.includes(story.dungeonToUnlock);
                    const storyEl = document.createElement('div');
                    storyEl.className = `p-4 rounded-lg transition-colors duration-300 ${isUnlocked ? 'bg-white/20 hover:bg-white/30 cursor-pointer' : 'bg-black/30 text-gray-500'}`;
                    if (isUnlocked) {
                        storyEl.dataset.storyIndex = index;
                        storyEl.dataset.storyType = 'main';
                    }

                    storyEl.innerHTML = `
                        <h3 class="text-xl font-bold ${isUnlocked ? 'text-yellow-300' : ''}">${story.title}</h3>
                        <p class="text-sm">${isUnlocked ? 'í´ë¦­í•˜ì—¬ ìŠ¤í† ë¦¬ ì½ê¸°' : `${story.dungeonToUnlock} í´ë¦¬ì–´ ì‹œ í•´ê¸ˆ`}</p>
                    `;
                    mainStoryContainer.appendChild(storyEl);
                });
            }

            function showMainStory(index, type) {
                const storyList = type === 'main' ? mainStories : eventStories;
                const story = storyList[index];
                document.getElementById('main-story-title').textContent = story.title;
                
                currentStoryPages = story.content.split('[PAGE_BREAK]');
                currentStoryPageIndex = 0;
                displayMainStoryPage();

                mainStoryModal.classList.remove('hidden');
            }

            function displayMainStoryPage() {
                const storyContent = document.getElementById('main-story-content');
                const pageIndicator = document.getElementById('main-story-page-indicator');
                
                storyContent.textContent = currentStoryPages[currentStoryPageIndex];
                pageIndicator.textContent = `${currentStoryPageIndex + 1} / ${currentStoryPages.length}`;
                
                mainStoryPrevButton.disabled = currentStoryPageIndex === 0;
                mainStoryNextButton.disabled = currentStoryPageIndex === currentStoryPages.length - 1;
            }

            function hideMainStory() {
                mainStoryModal.classList.add('hidden');
            }
            
            // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
            allTabs.forEach(tab => tab.addEventListener('click', () => switchTab(tab.id.split('-')[1])));
            pullOneButton.addEventListener('click', () => handlePull(1, PULL_ONE_COST, 'normal'));
            pullTenButton.addEventListener('click', () => handlePull(10, PULL_TEN_COST, 'normal'));
            pullOneEventButton.addEventListener('click', () => handlePull(1, PULL_ONE_COST, 'event'));
            pullTenEventButton.addEventListener('click', () => handlePull(10, PULL_TEN_COST, 'event'));
            expandInventoryButton.addEventListener('click', expandInventory);
            autoFillDeckButton.addEventListener('click', autoFillDeck);
            gachaTabNormal.addEventListener('click', () => switchGachaTab('normal'));
            gachaTabEvent.addEventListener('click', () => switchGachaTab('event'));
            
            const cardClickableContainers = [inventoryContainer, deckInventoryContainer, deckSlotsContainer, collectionContainer];
            cardClickableContainers.forEach(container => {
                container.addEventListener('click', (e) => {
                    const actionButton = e.target.closest('[data-action]');
                    if (actionButton) {
                        e.stopPropagation(); // Prevent card detail from opening when a button is clicked
                        const action = actionButton.dataset.action;
                        const cardName = actionButton.dataset.cardName;
                        if (action === 'set-representative') setRepresentative(cardName);
                        else if (action === 'add-to-deck') addToDeck(cardName);
                        else if (action === 'remove-from-deck') removeFromDeck(cardName);
                    } else {
                        const cardElement = e.target.closest('[data-card-name]');
                        if (cardElement) {
                             if (container === collectionContainer && cardElement.dataset.isCollected === 'false') {
                                return;
                            }
                            showCardDetails(cardElement.dataset.cardName);
                        }
                    }
                });
            });

            dungeonListContainer.addEventListener('click', (e) => { 
                const button = e.target.closest('[data-action="challenge-dungeon"]');
                if(button) challengeDungeon(parseInt(button.dataset.dungeonIndex), 'main'); 
            });
            homeCharacterContainer.addEventListener('click', () => { if (representativeCharacter) displayHomeView(true); });
            eventBanner.addEventListener('click', () => {
                showMessage(`[${EVENT_CHARACTER_NAME}] í™•ë¥  UP ì´ë²¤íŠ¸ ì§„í–‰ ì¤‘!`, 'text-blue-300', messageArea);
                switchTab('gacha');
            });
            resetButton.addEventListener('click', resetGame);
            closeCombatResultButton.addEventListener('click', () => {
                combatResultModal.classList.add('hidden');
                combatInProgressView.classList.add('hidden');

                if (lastCombatType === 'event') {
                    switchTab('event');
                    displayEventView();
                    switchSubTab(document.getElementById('event-view'), eventSubTabBattle);
                } else { // 'main'
                    switchTab('combat');
                }
            });
            closeCardDetailButton.addEventListener('click', hideCardDetails);
            cardDetailModal.addEventListener('click', (e) => {
                if (e.target === cardDetailModal) hideCardDetails();
            });

            mainStoryContainer.addEventListener('click', (e) => {
                const storyEl = e.target.closest('[data-story-index]');
                if (storyEl) {
                    showMainStory(parseInt(storyEl.dataset.storyIndex), 'main');
                }
            });

            eventStoryContainer.addEventListener('click', (e) => {
                const storyEl = e.target.closest('[data-story-index]');
                if (storyEl) {
                    showMainStory(parseInt(storyEl.dataset.storyIndex), 'event');
                }
            });

            eventShopContainer.addEventListener('click', (e) => {
                const button = e.target.closest('button');
                if (button && button.dataset.itemId) {
                    purchaseEventItem(button.dataset.itemId);
                }
            });

            closeMainStoryButton.addEventListener('click', hideMainStory);
            mainStoryModal.addEventListener('click', (e) => {
                if (e.target === mainStoryModal) hideMainStory();
            });

            detailStoryPrevButton.addEventListener('click', () => {
                if (currentStoryPageIndex > 0) {
                    currentStoryPageIndex--;
                    displayCardStoryPage();
                }
            });
            detailStoryNextButton.addEventListener('click', () => {
                if (currentStoryPageIndex < currentStoryPages.length - 1) {
                    currentStoryPageIndex++;
                    displayCardStoryPage();
                }
            });
            mainStoryPrevButton.addEventListener('click', () => {
                if (currentStoryPageIndex > 0) {
                    currentStoryPageIndex--;
                    displayMainStoryPage();
                }
            });
            mainStoryNextButton.addEventListener('click', () => {
                if (currentStoryPageIndex < currentStoryPages.length - 1) {
                    currentStoryPageIndex++;
                    displayMainStoryPage();
                }
            });


            speed1xButton.addEventListener('click', () => setCombatSpeed(1));
            speed2xButton.addEventListener('click', () => setCombatSpeed(2));
            speed4xButton.addEventListener('click', () => setCombatSpeed(4));

            eventSubTabBattle.addEventListener('click', () => switchSubTab(document.getElementById('event-view'), eventSubTabBattle));
            eventSubTabStory.addEventListener('click', () => switchSubTab(document.getElementById('event-view'), eventSubTabStory));
            eventSubTabShop.addEventListener('click', () => switchSubTab(document.getElementById('event-view'), eventSubTabShop));
            
            // --- ê²Œì„ ì‹œì‘ ---
            loadGame();
            startBookmarkRegenTimer();
        });
    </script>
</body>
</html>


